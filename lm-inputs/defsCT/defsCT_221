Definition 4.6. A symmetric monoidal $\infty$-category is an $\infty$-operad $p:\mathscr{C}^{\otimes}\to\mathscr{F}\mathrm{in}_{*}$ such that $p$ is a cocartesian fibration of $\infty$-operads. This condition implies that for $X_{1},\dots,X_{n},Y\in\mathscr{C}$, we have $\operatorname{Hom}_{\mathscr{C}^{\otimes}}(X_{1},\dots,X_{n};Y)\simeq% \operatorname{Hom}_{\mathscr{C}}(X_{1}\otimes\dots\otimes X_{n},Y)$ for some object $X_{1}\otimes\dots\otimes X_{n}$ that depends functorially on $X_{1},\dots,X_{n}$, and such that the operation $\otimes$ is associative and commutative up to higher coherent homotopies. This definition mimics the way in which a symmetric monoidal category can be viewed as a special kind of coloured operad. A map of $\infty$-operads $g:\mathscr{C}_{1}^{\otimes}\to\mathscr{C}_{2}^{\otimes}$ between symmetric monoidal $\infty$-categories is symmetric monoidal if it takes cocartesian morphisms in $\mathscr{C}_{1}^{\otimes}$ to cocartesian morphisms in $\mathscr{C}_{1}^{\otimes}$.
Definition 4.17. Applying 4.16 to the symmetric monoidal $\infty$-category $q_{\mathscr{C}}$ of Definition 4.15, there is a stable symmetric monoidal $\infty$-category $q_{\mathscr{C}}^{op}:\operatorname{Fun}(\hat{\mathscr{F}}_{\mathscr{C}}^{% \kappa},{\mathscr{S}p})^{op,\otimes}\to\mathscr{F}\mathrm{in}_{*}$ that represents the monoidal structure corresponding to Day convolution on the opposite $\infty$-category of the category of functors $\hat{\mathscr{F}}_{\mathscr{C}}^{\kappa}\to{\mathscr{S}p}$. Note that the multi-morphism spectra in $\operatorname{Fun}(\hat{\mathscr{F}}_{\mathscr{C}}^{\kappa},{\mathscr{S}p})^{% op,\otimes}$ are given by the mapping spectra $\operatorname{Nat}_{\hat{\mathscr{F}}_{\mathscr{C}}^{\kappa}}(\mathsf{A},% \mathsf{B}_{1}\otimes\dots\otimes\mathsf{B}_{n})$ and, comparing with Remark 2.7, this motivates the following definition.
Definition 7. A bisection of $\mathbf{C}$ is a map $b\colon\mathbf{C_{0}}\to\mathbf{C_{1}}$, such that • the map $s\circ b$ is the identity map, and • the map $t\circ b\colon\mathbf{C_{0}}\to\mathbf{C_{0}}$ is a bijection on $\mathbf{C_{0}}$.
Definition 3. The category of functors $\mathbf{C}^{\Delta}$ has (1) functors $F\colon\Delta\to\mathbf{C}$ as objects, and (2) natural transformations $\eta\colon F\to F^{\prime}$ between functors $F\colon\Delta\to\mathbf{C}$ and $F^{\prime}\colon\Delta\to\mathbf{C}$ as morphisms.
Definition 5. The category $\widetilde{\mathbf{G}^{\Delta}}$ is defined as the pull-back of the following diagram. $\widetilde{\mathbf{G}^{\Delta}}$$\widetilde{\mathbf{H}^{\Delta}}$$\mathbf{G}^{\Delta}$$\mathbf{H}^{\Delta}$$\iota$$\Pi$
Definition 1. Let $\mathbf{C}$ be a category, and $S$ a functor from $\mathbf{C}$ to the category $\mathbf{Sets}$ of (small) sets. Let $\Delta$ be a small category and $R$ a functor from $\Delta$ to $\mathbf{Sets}$ with non-empy values. A PK-net of form $R$ and of support $S$ is a 4-tuple $(R,S,F,\phi)$, in which $F$ is a functor from $\Delta$ to $\mathbf{C}$, and $\phi$ is a natural transformation from $R$ to $SF$.
Definition 4. For a given poset $\Delta$ with a bottom element, the functor $\Pi\colon\mathbf{G}^{\Delta}\to\mathbf{H}^{\Delta}$ induced by the homomorphism $\pi\colon G\to H$, is the functor which • is the identity on objects, and • sends any morphism ${}^{FF^{\prime}}g={}^{FF^{\prime}}(z,h)$ in $\mathbf{G}^{\Delta}$ to ${}^{FF^{\prime}}\pi(g)={}^{FF^{\prime}}h$ in $\mathbf{H}^{\Delta}$.
Definition 2. Let $\mathbf{C}$ be a category, and $\Delta$ be a small category. A generalized musical class is a functor $F\colon\Delta\to\mathbf{C}$. When $\mathbf{C}$ is the particular case of the group $T$/$I$, a functor $F\colon\Delta\to\mathbf{C}$ is said to be a generalized chord class.
Definition 6. A bisection of $\mathbf{C}$ is the data of a permutation $\sigma\in S_{n}$ and a collection of morphisms $g_{i\sigma(i)}$ of $\mathbf{C}$ for $i\in\{1,\ldots,n\}$. A bisection will be notated as $\langle(\ldots,g_{i\sigma(i)},\ldots),\sigma\rangle.$
Definition 3.1 ([18]). An $Ann$-category consists of: (i) A category $\mathcal{A}$ together with two bifunctors $\oplus,\otimes:\mathcal{A}\times\mathcal{A}\longrightarrow\mathcal{A}.$ (ii) A fixed object $0\in\mathcal{A}$ together with natural constraints $a^{+},c^{+},g,d$ such that $(\mathcal{A},\oplus,a^{+},c^{+},(0,g,d))$ is a symmetric categorical group. (iii) A fixed object $1\in\mathcal{A}$ together with natural constraints $a,l,r$ such that $(\mathcal{A},\otimes,a,(1,l,r))$ is a monoidal category. (iv) Natural isomorphisms $\mathfrak{L},\mathfrak{R}$ $\begin{array}[]{cccc}\mathfrak{L}_{A,X,Y}:&A\otimes(X\oplus Y)&\rightarrow&(A% \otimes X)\oplus(A\otimes Y),\\ \mathfrak{R}_{X,Y,A}:&(X\oplus Y)\otimes A&\rightarrow&(X\otimes A)\oplus(Y% \otimes A),\end{array}$ such that the following conditions are satisfied: (Ann-1) For each object $A\in\mathcal{A},$ the pairs $(L^{A},\breve{L^{A}}),(R^{A},\breve{R^{A}})$ defined by the relations: $\begin{array}[]{cccc}L^{A}=A\otimes-,&&R^{A}=-\otimes A,\\ \breve{L}_{X,Y}^{A}=\mathfrak{L}_{A,X,Y},&&\breve{R}_{X,Y}^{A}=\mathfrak{R}_{X% ,Y,A}\end{array}$ are $\oplus$-functors which are compatible with $a^{+}$ and $c^{+}$. (Ann-2) For all objects $A,B,X,Y\in\mathcal{A},$ the following diagrams: $\scriptsize\diagram\node{(AB)(X\oplus Y)}\arrow{s,l}{\breve{L}^{AB}}\node{A(B(% X\oplus Y))}\arrow{e,t}{id_{A}\otimes\breve{L}^{B}}\arrow{w,t}{\ a_{A,B,X% \oplus Y}}\node{A(BX\oplus BY)}\arrow{s,r}{\breve{L}^{A}}\\ \node{(AB)X\oplus(AB)Y}\node[2]{A(BX)\oplus A(BY)}\arrow[2]{w,t}{a_{A,B,X}% \oplus a_{A,B,Y}}$ $\scriptsize\diagram\node{(X\oplus Y)(BA)}\arrow{s,l}{\breve{R}^{BA}}\arrow{e,t% }{a_{X\oplus Y,B,A}}\node{((X\oplus Y)B)A}\arrow{e,t}{\breve{R}^{B}\otimes id_% {A}}\node{(XB\oplus YB)A}\arrow{s,r}{\breve{R}^{A}}\\ \node{X(BA)\oplus Y(BA)}\arrow[2]{e,t}{a_{X,B,A}\oplus a_{Y,B,A}}\node[2]{(XB)% A\oplus(YB)A}$ $\scriptsize\diagram\node{(A(X\oplus Y))B}\arrow{s,l}{\breve{L}^{A}\otimes id_{% B}}\node{A((X\oplus Y)B)}\arrow{w,t}{a_{A,X\oplus Y,B}}\arrow{e,t}{id_{A}% \otimes\breve{R}^{B}}\node{A(XB\oplus YB)}\arrow{s,r}{\breve{L}^{A}}\\ \node{(AX\oplus AY)B}\arrow{e,t}{\breve{R}^{B}}\node{(AX)B\oplus(AY)B}\node{A(% XB)\oplus A(YB)}\arrow{w,t}{a\ \oplus\ a}$ $\scriptsize\diagram\node{(A\oplus B)X\oplus(A\oplus B)Y}\arrow{s,l}{\breve{R}^% {X}\oplus\breve{R}^{Y}}\node{(A\oplus B)(X\oplus Y)}\arrow{w,t}{\breve{L}^{A% \oplus B}}\arrow{e,t}{\breve{R}^{X\oplus Y}}\node{A(X\oplus Y)\oplus B(X\oplus Y% )}\arrow{s,r}{\breve{L}^{A}\oplus\breve{L}^{B}}\\ \node{(AX\oplus BX)\oplus(AY\oplus BY)}\arrow[2]{e,t}{v}\node[2]{(AX\oplus AY)% \oplus(BX\oplus BY)}$ commute, where $v=v_{{}_{U,V,Z,T}}:(U\oplus V)\oplus(Z\oplus T)\rightarrow(U\oplus Z)\oplus(V% \oplus T)$ is the unique morphism built from $a^{+},c^{+},id$ in the symmetric categorical group $(\mathcal{A},\oplus).$ (Ann-3) For the unit object $1\in\mathcal{A}$ of the operation $\otimes,$ the following diagrams: $\scriptsize\diagram\node{1(X\oplus Y)}\arrow[2]{e,t}{\breve{L}^{1}}\arrow{se,b% }{l_{X\oplus Y}}\node[2]{1X\oplus 1Y}\arrow{sw,b}{l_{X}\oplus l_{Y}}\node{(X% \oplus Y)1}\arrow[2]{e,t}{\breve{R}^{1}}\arrow{se,b}{r_{{}_{X\oplus Y}}}\node[% 2]{X1\oplus Y1}\arrow{sw,b}{r_{{}_{X}}\oplus r_{{}_{Y}}}\\ \node[2]{X\oplus Y}\node{(5.1)}\node[2]{X\oplus Y}\node{(5.2)}$ commute.
Definition 3.3. Let $\mathcal{A}$, $\mathcal{A}^{\prime}$ be braided $Ann$-categories. A braided $Ann$-functor is an $Ann$-functor which is compatible with the braidings. In other words, a braided $Ann$-functor from $\mathcal{A}$ to $\mathcal{A}^{\prime}$ is a quadruple $(F,\breve{F},\widetilde{F},F_{\ast})$, where $(F,\breve{F}),$ $(F,\widetilde{F},F_{\ast})$ are symmetric monoidal functors, respectively, for $\oplus,$ $\otimes,$ and satisfies the two following commutative diagrams: $\scriptsize\diagram\node{F(X(Y\oplus Z))}\arrow{s,l}{F(\mathfrak{L})}\node{F(X% )F(Y\oplus Z)}\arrow{w,t}{\widetilde{F}}\node{F(X)(FY\oplus FZ)}\arrow{s,r}{% \mathfrak{L}^{\prime}}\arrow{w,t}{id\otimes\breve{F}}\\ \node{F(XY\oplus XZ)}\node{F(XY)\oplus F(XZ)}\arrow{w,t}{\breve{F}}\node{FXFY% \oplus FXFZ}\arrow{w,t}{\widetilde{F}\oplus\widetilde{F}}$ $\scriptsize\diagram\node{F((X\oplus Y)Z)}\arrow{s,l}{F(\mathfrak{R})}\node{F(X% \oplus Y)FZ}\arrow{w,t}{\widetilde{F}}\node{(FX\oplus FY)FZ}\arrow{s,r}{% \mathfrak{R}^{\prime}}\arrow{w,t}{\breve{F}\otimes id}\\ \node{F(XZ\oplus YZ)}\node{F(XZ)\oplus F(YZ)}\arrow{w,t}{\breve{F}}\node{FXFZ% \oplus FYFZ}\arrow{w,t}{\widetilde{F}\oplus\widetilde{F}}$ A braided $Ann$-morphism (or a homotopy) $u:(F,\breve{F},\widetilde{F},F_{\ast})\rightarrow(K,\breve{K},\widetilde{K},K_% {\ast})$ between braided $Ann$-functors is an $\oplus$-morphism as well as an $\otimes$-morphism. If there exists a braided $Ann$-functor $(K,\breve{K},\widetilde{K},K_{\ast}):\mathcal{A}^{\prime}\rightarrow\mathcal{A}$ and braided $Ann$-morphisms $KF\stackrel{{\scriptstyle\sim}}{{\rightarrow}}id_{\mathcal{A}},FK\stackrel{{% \scriptstyle\sim}}{{\rightarrow}}id_{\mathcal{A}^{\prime}}$, we say that $(F,\breve{F},\widetilde{F},F_{\ast})$ is a braided $Ann$-equivalence, and, $\mathcal{A}$ and $\mathcal{A}^{\prime}$ are braided $Ann$-equivalent.
Definition 5.1. A functor $F:\mathcal{S}\rightarrow\mathcal{S}^{\prime}$ is called a functor of the type $(p,q)$ if $F(x)=p(x),\ \ \ \ F(x,a)=(p(x),q(a)),$ where $p:R\rightarrow R^{\prime}$ is a ring homomorphism and $q:M\rightarrow M^{\prime}$ is a group homomorphism satisfying $q(xa)=p(x)q(a),\quad x\in R,a\in M.$
Definition 3.2. A braided $Ann$-category $\mathcal{A}$ is an $Ann$-category $\mathcal{A}$ together with a braiding $c$ such that $(\mathcal{A},\otimes,a,c,(1,l,r))$ is a braided monoidal category, and $c$ makes the following diagram $\scriptsize\diagram\node{A(X\oplus Y)}\arrow{e,t}{\breve{L}^{A}_{X,Y}}\arrow{s% ,l}{c}\node{AX\oplus AY}\arrow{s,r}{c\oplus c}\\ \node{(X\oplus Y)A}\arrow{e,t}{\breve{R}^{A}_{X,Y}}\node{XA\oplus YA}$ commutes and satisfies $c_{{}_{0,0}}=id$. A braided $Ann$-category is called a symmetric $Ann$-category if the braiding $c$ is symmetric.
Definition 2.9. A $J$-cocomplete $\mathcal{Q}$-category $X$ is $J$-continuous if the supremum $\textsf{S}_{X}\colon JX\to X$ has a left adjoint.
Definition 3.7. We say that a $\mathcal{Q}$-functor $f\colon X\to Y$ between $\mathcal{Q}$-categories reflects open modules if $\alpha\cdot f\in FX$ for every $\alpha\in F{Y}$. Let $(J,\mathcal{Q})\text{-}\mathbf{Dom}$ be the category of $J$-cocomplete, $J$-continuous and open module determined $\mathcal{Q}$-categories together with open module reflecting maps.
Definition 2.12. We say that a $J$-continuous $\mathcal{Q}$-category $X$ is open module determined if for all $x,y\in X$: $\mathord{\Downarrow}_{X}(x,y)=\bigvee_{\alpha\in FX}(\alpha(y)\otimes[\alpha,% \lambda_{X}(x)]).$
Definition 5.4. Let $\boldsymbol{A}$ and $\boldsymbol{B}$ be pregamps. A morphism from $\boldsymbol{A}$ to $\boldsymbol{B}$ is an ordered pair $\boldsymbol{f}=(f,\widetilde{f})$ such that $f\colon A\to B$ is a morphism of partial algebras, $\widetilde{f}\colon\widetilde{A}\to\widetilde{B}$ is a $(\vee,0)$-homomorphism, and $\delta_{\boldsymbol{B}}(f(x),f(y))=\widetilde{f}(\delta_{\boldsymbol{A}}(x,y))$ for all $x,y\in A$. Given morphisms $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ and $\boldsymbol{g}\colon\boldsymbol{B}\to\boldsymbol{C}$ of pregamps, the pair $\boldsymbol{g}\circ\boldsymbol{f}=(g\circ f,\widetilde{g}\circ\widetilde{f})$ is a morphism from $\boldsymbol{A}$ to $\boldsymbol{C}$. We denote by $\mathbf{PGamp}_{\mathscr{L}}$ the category of pregamps with the morphisms defined above. We denote by $\boldsymbol{P}_{\mathrm{ga}}$ the functor from the category of $\mathscr{L}$-algebras to $\mathbf{PGamp}_{\mathscr{L}}$ that maps an algebra $A$ to $(A,\Theta_{A},\operatorname{Con}_{\mathrm{c}}A)$, and a morphism of algebras $f$ to $(f,\operatorname{Con}_{\mathrm{c}}f)$. We denote by $\boldsymbol{C}_{\mathrm{pg}}$ the functor from $\mathbf{PGamp}_{\mathscr{L}}$ to $\mathbf{Sem}_{\vee,0}$ that maps a pregamp $\boldsymbol{A}$ to $\widetilde{A}$, and maps a morphism of pregamps $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ to the $(\vee,0)$-homomorphism $\widetilde{f}$.
Definition 9.1. Let $\mathcal{A}$ and $\mathcal{S}$ be categories, let $\Phi\colon\mathcal{A}\to\mathcal{S}$ be a functor. We introduce the following statements: (CLOS) $\mathcal{A}$ has all small directed colimits. (PROD) Any two objects of $\mathcal{A}$ have a product in $\mathcal{A}$. (CONT) The functor $\Phi$ preserves all small directed colimits.
Definition 5.33. Let $\mathcal{V}$ be a variety of algebras. The category of pregamps of $\mathcal{V}$, denoted by $\mathbf{PGamp}(\mathcal{V})$, is the full subcategory of $\mathbf{PGamp}_{\mathscr{L}}$ in which the objects are all the pregamps of $\mathcal{V}$.
Definition 6.6. The gamp $\boldsymbol{A}/I$ described in Proposition 6.5 is a quotient of $\boldsymbol{A}$, the morphism $\boldsymbol{\pi}$ is the canonical projection.
Definition 4.2. Let $A$, $B$ be partial algebras. A morphism of partial algebras is a map $f\colon A\to B$ such that $f(\vec{x})\in\operatorname{Def}_{\ell}(B)$ and $\ell(f(\vec{x}))=f(\ell(\vec{x}))$, for all $\ell\in\mathscr{L}$ and all $\vec{x}\in\operatorname{Def}_{\ell}(A)$. The category of partial algebras, denoted by $\mathbf{PAlg}_{\mathscr{L}}$, is the category in which the objects are the partial algebras and the arrows are the above-mentioned morphisms of partial algebras. A morphism $f\colon A\to B$ of partial algebras is strong if $(f(A))^{\operatorname{ar}(\ell)}\subseteq\operatorname{Def}_{\ell}(B)$ for each $\ell\in\mathscr{L}$. A partial algebra $A$ is finite if its universe is finite.
Definition 8.2. A norm-covering of a poset $P$ is a pair $(U,\partial)$, where $U$ is a supported poset and $\partial\colon U\to P$, $u\mapsto\partial u$ is an isotone map. We say that an ideal $\boldsymbol{u}$ of $U$ is sharp if the set $\{\partial u\mid u\in\boldsymbol{u}\}$ has a largest element, which we shall then denote by $\partial{\boldsymbol{u}}$. We shall denote by $\operatorname{Id_{s}}U$ the set of all sharp ideals of $U$, partially ordered by inclusion.
Definition 5.17. Let $\boldsymbol{\pi}\colon\boldsymbol{A}\to\boldsymbol{B}$ be a morphism of pregamps. The $0$-kernel of $\boldsymbol{\pi}$, denoted by $\ker_{0}\boldsymbol{\pi}$, is the $0$-kernel of $\widetilde{\pi}$ (cf. Definition 3.2). Let $P$ be a poset and let $\vec{\boldsymbol{\pi}}=(\boldsymbol{\pi}_{p})_{p\in P}\colon\vec{\boldsymbol{A% }}\to\vec{\boldsymbol{B}}$ be a natural transformation of $P$-indexed diagrams of pregamps. The $0$-kernel of $\vec{\boldsymbol{\pi}}$ is $\vec{I}=(\ker_{0}\boldsymbol{\pi}_{p})_{p\in P}$.
Definition 6.12. Let $\mathcal{V}$ be a variety of algebras, let $P$ be a poset, and let $\vec{\boldsymbol{A}}=(\boldsymbol{A}_{p},\boldsymbol{f}_{p,q}\mid p\leq q\text% { in }P)$ in $\mathbf{Gamp}(\mathcal{V})$. An ideal of $\vec{\boldsymbol{A}}$ is an ideal of $\boldsymbol{C}\circ\vec{A}$. It consists of a family $\vec{I}=(I_{p})_{p\in P}$ such that $I_{p}$ is an ideal of $\widetilde{A}_{p}$ and $\widetilde{f}_{p,q}(I_{p})\subseteq I_{q}$ for all $p\leq q$ in $P$. We denote by $\vec{\boldsymbol{A}}/\vec{I}=(\boldsymbol{A}_{p}/I_{p},\boldsymbol{g}_{p,q}% \mid p\leq q\text{ in }P)$, where $\boldsymbol{g}_{p,q}\colon\boldsymbol{A}_{p}/I_{p}\to\boldsymbol{A}_{q}/I_{q}$ is induced by $\boldsymbol{f}_{p,q}$, for all $p\leq q$ in $P$. The diagram $\vec{\boldsymbol{A}}/\vec{I}$ is a quotient of $\vec{\boldsymbol{A}}$.
Definition 4.8. A partial algebra $A$ satisfies an identity $t_{1}=t_{2}$ if $t_{1}(\vec{x})=t_{2}(\vec{x})$ for each tuple $\vec{x}$ of $A$ such that both $t_{1}(\vec{x})$ and $t_{2}(\vec{x})$ are defined in $A$. Otherwise we say that $A$ fails $t_{1}=t_{2}$. Let $\mathcal{V}$ be a variety of algebras, a partial algebra $A$ is a partial algebra of $\mathcal{V}$ if $A$ satisfies all identities of $\mathcal{V}$.
Definition 8.4. For cardinals $\kappa$, $\lambda$ and a poset $P$, let $(\kappa,{<}\lambda)\leadsto P$ hold if for every mapping $F\colon\mathfrak{P}(\kappa)\to[\kappa]^{<\lambda}$, there exists a one-to-one map $f\colon P\mathbin{\hookrightarrow}\nobreak\kappa$ such that $F(f(P\mathbin{\downarrow}p))\cap f(P\mathbin{\downarrow}q)\subseteq f(P% \mathbin{\downarrow}p)\,,\qquad\text{for all }p\leq q\text{ in }P\,.$ Notice that in case $P$ is lower finite, it is sufficient to verify the conclusion above for all $F\colon[\kappa]^{<\omega}\to[\kappa]^{<\lambda}$ isotone and all $p\prec q$ in $P$.
Definition 3.2. An ideal of a $(\vee,0)$-semilattice $S$ is a lower subset $I$ of $S$ such that $0\in I$ and $u\vee v\in I$ for all $u,v\in I$. We denote by $\operatorname{Id}S$ the lattice of ideals of $S$. Let $\phi\colon S\to T$ be a $(\vee,0)$-homomorphism. The $0$-kernel of $\phi$ is $\ker_{0}\phi=\{a\in S\mid\phi(a)=0\}$; it is an ideal of $S$. We say that $\phi$ separates zero if $\ker_{0}\phi=\{0\}$. Let $P$ be a poset, let $\vec{S}=(S_{p},\phi_{p,q}\mid p\leq q\text{ in }P)$ be a diagram of $(\vee,0)$-semilattices. An ideal of $\vec{S}$ is a family $(I_{p})_{p\in P}$ such that $I_{p}$ is an ideal of $S_{p}$ and $\phi_{p,q}(I_{p})\subseteq I_{q}$ for all $p\leq q$ in $P$. Let $\vec{\phi}=(\phi_{p})_{p\in P}\colon\vec{S}\to\vec{T}$ be a natural transformation of $P$-indexed diagrams of $(\vee,0)$-semilattices. The $0$-kernel of $\vec{\phi}$ is $\ker_{0}\vec{\phi}=(\ker_{0}\phi_{p})_{p\in P}$, it is an ideal of $\vec{S}$.
Definition 7.5. Let $B$ be an algebra. A locally finite property for $B$ is a property $(P)$ in a subgamp $\boldsymbol{A}$ of $\boldsymbol{G}(B)$ such that there exists a finite $X\subseteq B$ satisfying that for every finite full partial subalgebra $A^{*}$ of $B$ that contains $X$, there exists a finite $Y\subseteq B$ such that for every finite full partial subalgebra $A$ of $B$ that contains $A^{*}\cup Y$ and every finite $(\vee,0)$-subsemilattice $\widetilde{A}$ of $\operatorname{Con}_{\mathrm{c}}B$ that contains $\operatorname{Con}_{\mathrm{c}}^{A}(B)$, the subgamp $(A^{*},A,\Theta_{B},\widetilde{A})$ of $\boldsymbol{G}(B)$ satisfies $(P)$.
Definition 5.13. A morphism $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ of pregamps is congruence-tractable if for all $m<\omega$ and for all $x,y,x_{0},y_{0},\dots,x_{m-1},y_{m-1}$ in $A$ such that: $\delta_{\boldsymbol{B}}(x,y)\leq\bigvee_{k<m}\delta_{\boldsymbol{B}}(x_{k},y_{% k}),$ there are a positive integer $n$, a list $\vec{z}$ of parameters from $B$, and terms $t_{0}$, …, $t_{n}$ such that the following equations are satisfied in $B$ (in particular, all the corresponding terms are defined). $\displaystyle f(x)$ $\displaystyle=t_{0}(f(\vec{x}),f(\vec{y}),\vec{z}),$ $\displaystyle f(y)$ $\displaystyle=t_{n}(f(\vec{x}),f(\vec{y}),\vec{z}),$ $\displaystyle t_{j}(f(\vec{y}),f(\vec{x}),\vec{z})$ $\displaystyle=t_{j+1}(f(\vec{x}),f(\vec{y}),\vec{z})\quad(\text{for all }j<n).$
Definition 6.2. A gamp of lattices is a gamp of the variety of all lattices. Let $\boldsymbol{B}$ be a gamp of lattices. A chain of $\boldsymbol{B}$ is a sequence $x_{0},x_{1},\dots,x_{n-1}$ of $B^{*}$ such that $x_{i}\wedge x_{j}=x_{i}$ in $B$ for all $i\leq j<n$. We sometime denote such a chain as $x_{0}\leq x_{1}\leq\dots\leq x_{n-1}$. If $x_{i}\not=x_{j}$ for all $i<j<n$, we denote the chain as $x_{0}<x_{1}<\dots<x_{n-1}$. Let $u<v$ be a chain of $\boldsymbol{B}$, we say that $v$ is a cover of $u$, and then we write $u\prec v$, if there is no chain $u<x<v$ in $\boldsymbol{B}$.
Definition 3.11. A $(\vee,0)$-homomorphism $\phi\colon S\to T$ is ideal-induced if $\phi$ is surjective and for all $x,y\in S$ with $\phi(x)=\phi(y)$ there exists $z\in S$ such that $x\vee z=y\vee z$ and $\phi(z)=0$. Let $P$ be a poset, let $\vec{S}=(S_{p},\phi_{p,q}\mid p\leq q\text{ in }P)$ and $\vec{T}=(T_{p},\psi_{p,q}\mid p\leq q\text{ in }P)$ be $P$-indexed diagrams of $(\vee,0)$-semilattices. A natural transformation $\vec{\pi}=(\pi_{p})_{p\in P}\colon\vec{S}\to\vec{T}$ is ideal-induced if $\pi_{p}$ is ideal-induced for each $p\in P$.
Definition 6.14. Let $\mathcal{V}$ be a variety of algebras, let $P$ be a poset. A partial lifting in $\mathcal{V}$ is a diagram $\vec{\boldsymbol{A}}=(\boldsymbol{A}_{p},\boldsymbol{f}_{p,q}\mid p\leq q\text% { in }P)$ in $\mathbf{Gamp}(\mathcal{V})$ such that the following statements hold: (1) The gamp $\boldsymbol{A}_{p}$ is strong, congruence-tractable, distance-generated, and has an isomorphic realization (cf. Definitions 6.3 and 6.1), for each $p\in P$. (2) The morphisms $\boldsymbol{f}_{p,q}$ is strong and congruence-cuttable (cf. Definition 6.3), for all $p<q$ in $P$. The partial lifting is a lattice partial lifting if $\mathcal{V}$ is a variety of lattices, $\boldsymbol{B}_{p}$ is distance-generated with chains for each $p\in P$, and $\boldsymbol{f}_{p,q}$ is congruence-cuttable with chains for all $p<q$ in $P$. A partial lifting $\vec{\boldsymbol{A}}$ is congruence $n$-permutable if $\boldsymbol{A}_{p}$ is congruence $n$-permutable for each $p\in P$. Let $\vec{S}=(S_{p},\sigma_{p,q})$ be a diagram in $\mathbf{Sem}_{\vee,0}$. A partial lifting of $\vec{S}$ is a partial lifting of $\vec{\boldsymbol{A}}$ such that $\boldsymbol{C}\circ\vec{\boldsymbol{A}}\cong\vec{S}$.
Definition 5.1. Let $A$ be a partial algebra, let $S$ be a $(\vee,0)$-semilattice. A $S$-valued partial algebra distance on $A$ is a map $\delta\colon A^{2}\to S$ such that: (1) $\delta(x,y)=0$ if and only if $x=y$, for all $x,y\in A$. (2) $\delta(x,y)=\delta(y,x)$, for all $x,y\in A$. (3) $\delta(x,y)\leq\delta(x,z)\vee\delta(z,y)$, for all $x,y,z\in A$. (4) $\delta(\ell(\vec{x}),\ell(\vec{y}))\leq\bigvee_{k<\operatorname{ar}(\ell)}% \delta(x_{k},y_{k})$, for all $\ell\in\mathscr{L}$ and all $\vec{x},\vec{y}\in\operatorname{Def}_{\ell}(A)$. Then we say that $\boldsymbol{A}=(A,\delta,S)$ is a pregamp. We shall generally write $\delta_{\boldsymbol{A}}=\delta$ and $\widetilde{A}=S$. The pregamp is distance-generated if it satisfies the following additional property: $(5)$ $S$ is join-generated by $\delta_{\boldsymbol{A}}(A^{2})$. That is, for all $\alpha\in S$ there are $n\geq 0$ and $n$-tuples $\vec{x},\vec{y}$ of $A$ such that $\alpha=\bigvee_{k<n}\delta_{\boldsymbol{A}}(x_{k},y_{k})$.
Definition 8.6. Let $P$ be a poset with a smallest element, let $X\subseteq P$, let $\vec{R}=(R_{x})_{x\in X}$ be a family of sets, let $\alpha\leq\omega$. Consider the following poset: $T=\{(n,\vec{x},\vec{r})\mid n<\alpha,\ \vec{x}\in X^{n},\text{ and }\vec{r}\in R% _{x_{0}}\times\dots\times R_{x_{n-1}}\},$ ordered by $(m,\vec{x},\vec{r})\leq(n,\vec{y},\vec{s})$ if and only if $m\leq n$, $\vec{x}=\vec{y}\mathbin{\restriction}m$, and $\vec{r}=\vec{s}\mathbin{\restriction}m$. Recall that $\vec{y}\mathbin{\restriction}m=(y_{0},\dots,y_{m-1})$. Given $t=(n,\vec{x},\vec{r})\in T$ and $m\leq n$, we set $t\mathbin{\restriction}m=(m,\vec{x}\mathbin{\restriction}m,\vec{r}\mathbin{% \restriction}m)$. Put: $A={{P}}\mathbin{\boxtimes}_{{\vec{R}}}{{\alpha}}=T\times P=\bigcup_{n\in\alpha% }\bigcup_{\vec{x}\in X^{n}}\Big{(}\{n\}\times\{\vec{x}\}\times(R_{x_{0}}\times% \dots\times R_{x_{n-1}})\times P\Big{)}.$ Any element of $A$ can be written $(n,\vec{x},\vec{r},p)$ with $n<\alpha$, $\vec{x}\in X^{n}$ and $\vec{r}\in R_{x_{0}}\times\dots\times R_{x_{n-1}}$. We define an order on $A$ by $(m,\vec{x},\vec{r},p)\leq(n,\vec{y},\vec{s},q)$ if and only if the following conditions hold: (1) $(m,\vec{x},\vec{r})\leq(n,\vec{y},\vec{s})$. (2) If $m=n$ then $p\leq q$. (3) If $m<n$ then $p\leq y_{m}$.
Definition 5.32. A pregamp $\boldsymbol{A}$ satisfies an identity $t_{1}=t_{2}$ if $A/I$ satisfies $t_{1}=t_{2}$ for each $I\in\operatorname{Id}\boldsymbol{A}$. Let $\mathcal{V}$ be a variety of algebras. A pregamp $\boldsymbol{A}$ is a pregamp of $\mathcal{V}$ if it satisfies all identities of $\mathcal{V}$.
Definition 8.1. A finite subset $V$ of a poset $U$ is a kernel if for every $u\in U$, there exists a largest element $v\in V$ such that $v\leq u$. We say that $U$ is supported if every finite subset of $U$ is contained in a kernel of $U$.
Definition 5.16. An ideal of a pregamp $\boldsymbol{A}$ is an ideal of $\widetilde{A}$. Denote by $\operatorname{Id}\boldsymbol{A}=\operatorname{Id}\widetilde{A}$ the set of all ideals of $\boldsymbol{A}$. Let $P$ be a poset, let $\vec{\boldsymbol{A}}=(\boldsymbol{A}_{p},\boldsymbol{f}_{p,q}\mid p\leq q\text% { in }P)$ be a $P$-indexed diagram in $\mathbf{PGamp}_{\mathscr{L}}$. An ideal of $\vec{\boldsymbol{A}}$ is an ideal of $(\widetilde{A}_{p},\widetilde{f}_{p,q}\mid p\leq q\text{ in }P)$ (cf. Definition 3.2).
Definition 6.3. A gamp $\boldsymbol{A}$ is strong if the following holds: $(1)$ $A^{*}$ is a strong partial subalgebra of $A$ (cf. Definition 4.4). A gamp $\boldsymbol{A}$ is distance-generated if it satisfies the following condition: $(2)$ Every element of $\widetilde{A}$ is a finite join of elements of the form $\delta_{\boldsymbol{A}}(x,y)$ where $x,y\in A^{*}$. A gamp $\boldsymbol{A}$ of lattices is distance-generated with chains if $(3)$ For all $\alpha\in\widetilde{A}$ there are a positive integer $n$, and chains $x_{0}<y_{0},x_{1}<y_{1},\dots,x_{n-1}<y_{n-1}$ of $\boldsymbol{A}$ such that $\alpha=\bigvee_{k<n}\delta_{\boldsymbol{A}}(x_{k},y_{k})$. A gamp $\boldsymbol{A}$ is congruence-tractable (cf. Lemma 5.11) if $(4)$ For all $x,y,x_{0},y_{0},\dots,x_{m-1},y_{m-1}$ in $A^{*}$, if $\delta_{\boldsymbol{A}}(x,y)\leq\bigvee_{k<m}\delta_{\boldsymbol{A}}(x_{k},y_{% k})$ then there are a positive integer $n$, a list $\vec{z}$ of parameters from $A$, and terms $t_{0}$, …, $t_{n}$ such that the following equations are satisfied in $A$. $\displaystyle x$ $\displaystyle=t_{0}(\vec{x},\vec{y},\vec{z}),$ $\displaystyle y$ $\displaystyle=t_{n}(\vec{x},\vec{y},\vec{z}),$ $\displaystyle t_{k}(\vec{y},\vec{x},\vec{z})$ $\displaystyle=t_{k+1}(\vec{x},\vec{y},\vec{z})\quad(\text{for all }k<n).$ A morphism $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ of gamps is strong if $(5)$ $f(A)$ is a strong partial subalgebra of $B^{*}$ (cf. Definition 4.4). A morphism $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ of gamps is congruence-cuttable if (6) $f(A)$ is a partial sublattice of $B^{*}$ and given a finite subset $X$ of $\widetilde{B}$ and $x,y\in A$ with $\delta_{\boldsymbol{A}}(f(x),f(y))\leq\bigvee X$, there are $n<\omega$ and $f(x)=x_{0},\dots,x_{n}=f(y)$ in $B^{*}$ such that $\delta_{\boldsymbol{A}}(x_{k},x_{k+1})\in\widetilde{B}\mathbin{\downarrow}X$ for all $k<n$. A morphism $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ of gamps of the variety of all lattices is congruence-cuttable with chains if $(7)$ $f(A)$ is a partial sublattice of $B^{*}$ and given a finite subset $X$ of $\widetilde{B}$ and $x,y\in A$ with $\delta_{\boldsymbol{A}}(f(x),f(y))\leq\bigvee X$, there is a chain $x_{0}<\dots<x_{n}$ of $\boldsymbol{B}$ such that $x_{0}=f(x)\wedge f(y)$, $x_{n}=f(x)\vee f(y)$, and $\delta_{\boldsymbol{A}}(x_{k},x_{k+1})\in\widetilde{B}\mathbin{\downarrow}X$ for all $k<n$. Let $n\geq 1$ be an integer. A gamp $\boldsymbol{A}$ is congruence $n$-permutable if the following statement holds: $(8)$ For all $x_{0},x_{1},\dots,x_{n}\in A^{*}$, there are $x_{0}=y_{0},y_{1},\dots,y_{n}=x_{n}$ in $A$ such that: $\displaystyle\delta_{\boldsymbol{A}}(y_{k},y_{k+1})$ $\displaystyle\leq\bigvee(\delta_{\boldsymbol{A}}(x_{i},x_{i+1})\mid i<n\text{ % even}),$ $\displaystyle\text{for all $k<n$ odd},$ $\displaystyle\delta_{\boldsymbol{A}}(y_{k},y_{k+1})$ $\displaystyle\leq\bigvee(\delta_{\boldsymbol{A}}(x_{i},x_{i+1})\mid i<n\text{ % odd}),$ $\displaystyle\text{for all $k<n$ even}.$
Definition 4.1. A partial algebra $A$ is a set (the universe of the partial algebra), given with a set $D_{\ell}=\operatorname{Def}_{\ell}(A)\subseteq A^{\operatorname{ar}(\ell)}$ and a map $\ell^{A}\colon D_{\ell}\to A$ called a partial operation, for each $\ell\in\mathscr{L}$. Let $\ell\in\mathscr{L}$ be an $n$-ary operation. If $\vec{x}\in\operatorname{Def}_{\ell}(A)$ we say that $\ell^{A}(\vec{x})$ is defined in $A$. We generalize this notion to terms in the usual way. For example, given binary operations $\ell_{1}$ and $\ell_{2}$ of a partial algebra $A$ and $x,y,z\in A$, $\ell_{1}^{A}(\ell_{2}^{A}(x,y),\ell_{1}^{A}(y,z))$ is defined in $A$ if and only if $(x,y)\in\operatorname{Def}_{\ell_{2}}(A)$, $(y,z)\in\operatorname{Def}_{\ell_{1}}(A)$, and $(\ell_{2}^{A}(x,y),\ell_{1}^{A}(y,z))\in\operatorname{Def}_{\ell_{1}}(A)$. Given a term $t$, we denote by $\operatorname{Def}_{t}(A)$ the set of all tuples $\vec{x}$ of $A$ such that $t(\vec{x})$ is defined in $A$.
Definition 7.1. Fix a gamp $\boldsymbol{A}$ in a variety $\mathcal{V}$, a $(\vee,0)$-semilattice $S$, and a $(\vee,0)$-homomorphism $\phi\colon\widetilde{A}\to S$. The gamp $\boldsymbol{A}$ is distance-generated through $\phi$ if the following statement holds: $(2^{\prime})$ For each $s\in S$ there are $n<\omega$ and $n$-tuple $\vec{x},\vec{y}$ of $A^{*}$ such that: $s=\bigvee_{k<n}\phi(\delta_{\boldsymbol{A}}(x_{k},y_{k}))$ If $\boldsymbol{A}$ is a gamp of lattices, we say $\boldsymbol{A}$ is distance-generated with chains through $\phi$ if $(3^{\prime})$ For each $s\in S$ there are $n<\omega$ and chains $x_{0}<y_{0},\dots,x_{n-1}<y_{n-1}$ of $\boldsymbol{A}$ such that: $s=\bigvee_{k<n}\phi(\delta_{\boldsymbol{A}}(x_{k},y_{k}))$ The gamp $\boldsymbol{A}$ is congruence-tractable through $\phi$ if the following statement holds: $(4^{\prime})$ Let $x,y,x_{0},y_{0},\dots,x_{m-1},y_{m-1}$ in $A^{*}$, if $\phi(\delta_{\boldsymbol{A}}(x,y))\leq\bigvee_{k<m}\phi(\delta_{\boldsymbol{A}% }(x_{k},y_{k}))$ then there are a positive integer $n$, a list $\vec{z}$ of parameters from $A$, and terms $t_{0}$, …, $t_{n}$ such that, the following equations are satisfied in $A$: $\displaystyle\phi(\delta_{\boldsymbol{A}}(x,t_{0}(\vec{x},\vec{y},\vec{z})))$ $\displaystyle=0,$ $\displaystyle\phi(\delta_{\boldsymbol{A}}(y,t_{n}(\vec{x},\vec{y},\vec{z})))$ $\displaystyle=0,$ $\displaystyle\phi(\delta_{\boldsymbol{A}}(t_{j}(\vec{y},\vec{x},\vec{z}),t_{j+% 1}(\vec{x},\vec{y},\vec{z})))$ $\displaystyle=0\quad(\text{for all }j<n).$ A morphism $\boldsymbol{f}\colon\boldsymbol{U}\to\boldsymbol{A}$ of gamps is congruence-cuttable through $\phi$ if the following statement holds: $(6^{\prime})$ Given $X\subseteq S$, given $x,y$ in $U$, if $\phi(\widetilde{f}(\delta_{\boldsymbol{A}}(x,y)))\leq\bigvee X$ then there exist $n<\omega$ and $f(x)=x_{0},x_{1},\dots,x_{n}=f(y)$ in $A^{*}$ such that $\delta_{\boldsymbol{A}}(x_{k},x_{k+1})\in S\mathbin{\downarrow}X$ for all $k<n$. A morphism $\boldsymbol{f}\colon\boldsymbol{U}\to\boldsymbol{A}$ of gamps of lattices is congruence-cuttable with chains through $\phi$ if the following statement holds: $(7^{\prime})$ Given $X\subseteq S$, given $x,y\in U$, if $\phi(\widetilde{f}(\delta_{\boldsymbol{A}}(x,y)))\leq\bigvee X$ then there are $n<\omega$ and a chain $x_{0}<x_{1}<\dots<x_{n}$ of $\boldsymbol{A}$ such that $x_{0}=f(x)\wedge f(y)$, $x_{n}=f(x)\vee f(y)$, and $\phi(\delta_{\boldsymbol{A}}(x_{k},x_{k+1}))\in S\mathbin{\downarrow}X$ for all $k<n$.
Definition 4.4. Given a partial algebra $A$, a partial subalgebra $B$ of $A$ is a subset $B$ of $A$ endowed with a structure of partial algebra such that $\operatorname{Def}_{\ell}(B)\subseteq\operatorname{Def}_{\ell}(A)$ and $\ell^{A}(\vec{x})=\ell^{B}(\vec{x})$ for all $\ell\in\mathscr{L}$ and all $\vec{x}\in\operatorname{Def}_{\ell}(B)$. The inclusion map from $A$ into $B$ is a morphism of partial algebras called the inclusion morphism. A partial subalgebra $B$ of $A$ is full if whenever $\ell\in\mathscr{L}$ and $\vec{x}\in B^{\operatorname{ar}(\ell)}$ are such that $\ell^{A}(\vec{x})$ is defined and belongs to $B$, then $\ell(\vec{x})$ is defined in $B$. It is equivalent to the following equality: $\operatorname{Def}_{\ell}(B)=\{\vec{x}\in\operatorname{Def}_{\ell}(A)\cap B^{% \operatorname{ar}(\ell)}\mid\ell(\vec{x})\in B\},\quad\text{ for each $\ell\in% \mathscr{L}$.}$ A partial subalgebra $B$ of $A$ is strong if the inclusion map is a strong morphism, that is, $B^{\operatorname{ar}(\ell)}\subseteq\operatorname{Def}_{\ell}(A)$ for each $\ell\in\mathscr{L}$. An embedding of partial algebras is a one-to-one morphism of partial algebras.
Definition 5.19. A morphism $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ of pregamps, is ideal-induced if $f(A)=B$ as partial algebras and $\widetilde{f}$ is ideal-induced. In that case we say that $\boldsymbol{B}$ is an ideal-induced image of $\boldsymbol{A}$. Let $P$ be a poset, let $\vec{\boldsymbol{A}}$ and $\vec{\boldsymbol{B}}$ be $P$-indexed diagrams of pregamps. A natural transformation $\vec{\boldsymbol{f}}=(\boldsymbol{f}_{p})_{p\in P}\colon\vec{\boldsymbol{A}}% \to\vec{\boldsymbol{B}}$ is ideal-induced if $\boldsymbol{f}_{p}$ is ideal-induced for each $p\in P$.
Definition 8.3. Let $P$ be a poset. An $\aleph_{0}$-lifter of $P$ is a pair $(U,\boldsymbol{U})$, where $U$ is a norm-covering of $P$ and $\boldsymbol{U}$ is a subset of $\operatorname{Id_{s}}U$ satisfying the following properties: (1) The set $\boldsymbol{U}^{=}=\{\boldsymbol{u}\in\boldsymbol{U}\mid\partial\boldsymbol{u}% \text{ is not maximal in }P\}$ is lower finite, that is, the set $\boldsymbol{U}\mathbin{\downarrow}\boldsymbol{u}$ is finite for each $\boldsymbol{u}\in\boldsymbol{U}^{=}$. (2) For every map $S\colon\boldsymbol{U}^{=}\to[U]^{<\omega}$, there exists an isotone map $\sigma\colon P\to\boldsymbol{U}$ such that (a) the map $\sigma$ is a section of $\partial$, that is, $\partial\sigma(p)=p$ holds for each $p\in P$; (b) the containment $S(\sigma(p))\cap\sigma(q)\subseteq\sigma(p)$ holds for all $p<q$ in $P$. (Observe that $\sigma(p)$ belongs to $\boldsymbol{U}^{=}$.)
Definition 6.8. Let $A$ be a member of a variety $\mathcal{V}$ of algebras. Then the quadruple $\boldsymbol{G}(A)=(A,A,\Theta_{A},\operatorname{Con}_{\mathrm{c}}A)$ is a gamp of $\mathcal{V}$ (we recall that $\Theta_{A}(x,y)$ denotes the smallest congruence that identifies $x$ and $y$). If $f\colon A\to B$ is a morphism of algebras, then $\boldsymbol{G}(f)=(f,\operatorname{Con}_{\mathrm{c}}f)$ is a morphism of gamps from $\boldsymbol{G}(A)$ to $\boldsymbol{G}(B)$. It defines a functor from the category $\mathcal{V}$ to the category $\mathbf{Gamp}(\mathcal{V})$. A gamp $\boldsymbol{A}$ is an algebra if $\boldsymbol{A}$ is isomorphic to $\boldsymbol{G}(B)$ for some $B$. A gamp $\boldsymbol{A}$ is an algebra of a variety $\mathcal{V}$ if $\boldsymbol{A}$ is isomorphic to $\boldsymbol{G}(B)$ for some $B\in\mathcal{V}$. Let $\boldsymbol{A}$ be a gamp of $\mathcal{V}$, we set $\boldsymbol{C}(\boldsymbol{A})=\widetilde{A}$. Let $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ be a morphism of gamps of $\mathcal{V}$, we set $\boldsymbol{C}(\boldsymbol{f})=\widetilde{f}$. This defines a functor $\boldsymbol{C}\colon\mathbf{Gamp}(\mathcal{V})\to\mathbf{Sem}_{\vee,0}$. Let $\boldsymbol{A}$ be a gamp of $\mathcal{V}$, we set $\boldsymbol{P}_{\mathrm{gr}}(\boldsymbol{A})=(A,\delta_{\boldsymbol{A}},% \widetilde{A})$. Let $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ be a morphism of gamps of $\mathcal{V}$, we put $\boldsymbol{P}_{\mathrm{gr}}(\boldsymbol{f})=\boldsymbol{f}$ as a morphism of pregamps. This defines a functor $\boldsymbol{P}_{\mathrm{gr}}\colon\mathbf{Gamp}(\mathcal{V})\to\mathbf{PGamp}(% \mathcal{V})$. Let $\boldsymbol{A}$ be a gamp of $\mathcal{V}$, we set $\boldsymbol{P}_{\mathrm{gl}}(\boldsymbol{A})=(A^{*},\delta_{\boldsymbol{A}}% \mathbin{\restriction}(A^{*})^{2},\widetilde{A})$. Let $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ be a morphism of gamps of $\mathcal{V}$, we denote by $\boldsymbol{P}_{\mathrm{gl}}(\boldsymbol{f})$ the restriction $(f,\widetilde{f})\colon\boldsymbol{P}_{\mathrm{gl}}(\boldsymbol{A})\to% \boldsymbol{P}_{\mathrm{gl}}(\boldsymbol{B})$. This defines a functor $\boldsymbol{P}_{\mathrm{gl}}\colon\mathbf{Gamp}(\mathcal{V})\to\mathbf{PGamp}(% \mathcal{V})$.
Definition 5.8. An embedding $\boldsymbol{f}\colon\boldsymbol{B}\to\boldsymbol{A}$ of pregamps is a morphism of pregamps such that $f$ and $\widetilde{f}$ are both one-to-one. A sub-pregamp of a pregamp $\boldsymbol{A}$ is a pregamp $\boldsymbol{B}$ such that $B$ is a partial subalgebra of $A$, $\widetilde{B}$ is a $(\vee,0)$-subsemilattice of $\widetilde{A}$, and $\delta_{\boldsymbol{B}}=\delta_{\boldsymbol{A}}\mathbin{\restriction}B^{2}$. If $f\colon B\to A$ and $\widetilde{f}\colon\widetilde{B}\to\widetilde{A}$ denote the inclusion maps, the morphism of pregamps $\boldsymbol{f}=(f,\widetilde{f})$ is called the canonical embedding.
Definition 10.1. A gamp $\boldsymbol{A}$ of lattices is lattice congruence $n$-permutable if for all $x_{0},\dots,x_{n}$ in $A^{*}$ there exist $y_{0},\dots,y_{n}$ in $A$ such that $y_{i}\wedge y_{j}=y_{j}\wedge y_{i}=y_{i}$ in $A$ for all $i\leq j\leq n$, $y_{0}=x_{0}\wedge x_{n}=x_{n}\wedge x_{0}$ in $A$, $y_{n}=x_{0}\vee x_{n}=x_{n}\vee x_{0}$ in $A$, and: $\delta(y_{k},y_{k+1})\leq\bigvee(\delta(x_{i},x_{i+1})\mid i<n\text{ even}),% \quad\text{for all $k<n$ odd},$ $\delta(y_{k},y_{k+1})\leq\bigvee(\delta(x_{i},x_{i+1})\mid i<n\text{ odd}),% \quad\text{for all $k<n$ even}.$ A morphism $\boldsymbol{f}\colon\boldsymbol{A}\to\boldsymbol{B}$ of gamps is operational if $\ell(\vec{x})$ is defined in $B$ for all $\ell\in\mathscr{L}$ and all $\operatorname{ar}(\ell)$-tuple $\vec{X}$ in $f(A)\cup B^{*}$. Let $P$ be a poset, a diagram $\vec{\boldsymbol{A}}=(\boldsymbol{A}_{p},\boldsymbol{f}_{p,q}\mid p\leq q\text% { in }P)$ of gamps is operational if $\boldsymbol{f}_{p,q}$ is operational for all $p<q$ in $P$.
Definition 6.1. Let $\mathcal{V}$ be a variety of $\mathscr{L}$-algebras. A gamp (resp., a gamp of $\mathcal{V}$) is a quadruple $\boldsymbol{A}=(A^{*},A,\delta_{\boldsymbol{A}},\widetilde{A})$ such that (1) $(A,\delta_{\boldsymbol{A}},\widetilde{A})$ is a pregamp (resp., a pregamp of $\mathcal{V}$) (cf. Definitions 5.1 and 5.32). (2) $A^{*}$ is a partial subalgebra of $A$. A realization of $\boldsymbol{A}$ is an ordered pair $(A^{\prime},\chi)$ such that $A^{\prime}\in\mathcal{V}$, $A$ is a partial subalgebra of $A^{\prime}$, $\chi\colon\widetilde{A}\to\operatorname{Con}_{\mathrm{c}}A^{\prime}$ is a $(\vee,0)$-embedding, and $\chi(\delta_{\boldsymbol{A}}(x,y))=\Theta_{A^{\prime}}(x,y)$ for all $x,y\in A$. A realization is isomorphic if $\chi$ is an isomorphism. A gamp $\boldsymbol{A}$ is finite if both $A$ and $\widetilde{A}$ are finite. Let $\boldsymbol{A}$ and $\boldsymbol{B}$ be gamps. A morphism $\boldsymbol{f}\colon(A,\delta_{\boldsymbol{A}},\widetilde{A})\to(B,\delta_{% \boldsymbol{B}},\widetilde{B})$ of pregamps is a morphism of gamps from $\boldsymbol{A}$ to $\boldsymbol{B}$ if $f(A^{*})$ is a partial subalgebra of $B^{*}$. The category of gamps of $\mathcal{V}$, denoted by $\mathbf{Gamp}(\mathcal{V})$, is the category in which the objects are the gamps of $\mathcal{V}$ and the arrows are the morphisms of gamps. A subgamp of a gamp $\boldsymbol{A}$ is a gamp $\boldsymbol{B}=(B^{*},B,\delta_{\boldsymbol{B}},\widetilde{B})$ such that $B^{*}$ is a partial subalgebra of $A^{*}$, $B$ is a partial subalgebra of $A$, $\delta_{\boldsymbol{B}}=\delta_{\boldsymbol{A}}\mathbin{\restriction}B^{2}$, and $\widetilde{B}$ is a $(\vee,0)$-subsemilattice of $\widetilde{A}$. Let $f\colon B\to A$ and $\widetilde{f}\colon\widetilde{B}\to\widetilde{A}$ be the inclusion maps. The ordered pair $(f,\widetilde{f})$ is a morphism of gamps from $\boldsymbol{B}$ to $\boldsymbol{A}$, called the canonical embedding.
Definition 4.10. Let $\mathcal{C}_{0}$ be an ind-closed category. An internal cover of $\mathcal{C}_{0}$ consists of an ind-closed category $\mathcal{C}$, together with closed functors $\mathscr{I}:\mathcal{C}_{0}\xrightarrow{}\mathcal{C}$ and $\mathscr{F}:\mathcal{C}\xrightarrow{}\mathcal{C}_{0}$, and an isomorphism of $\mathscr{F}\circ\mathscr{I}$ with the identity functor (we will ignore this isomorphism in the notation and assume that $\mathscr{F}\circ\mathscr{I}$ is the identity functor).
Definition 2.3. We will say that a category $\mathcal{C}$ with finite inverse limits is ind-closed if $\underline{Hom}(\mathbf{X},\mathbf{Y})$ is ind-representable for all objects $\mathbf{X}$ and $\mathbf{Y}$.
Definition 5.1. A map $f:\mathbf{X}\xrightarrow{}\mathbf{Y}$ in $\operatorname{Ind}({\mathcal{C}})$ is called proper if for any $g:\mathbf{Z}\xrightarrow{}\mathbf{Y}$ with $\mathbf{Z}$ compact, the pullback $\mathbf{X}\times_{\mathbf{Y}}\mathbf{Z}$ is also compact. An ind-object $\mathbf{Y}$ is called semi-strict if any map from a compact object to $\mathbf{Y}$ is proper.
