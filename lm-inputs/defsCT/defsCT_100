Definition 31. A ideal category or ideal generalized category is a structure $(\mathscr{C},\vdash,\mathscr{V})$ consisting of a generalized category $\mathscr{C}$ (section 3), a distinguished subset of elements $\mathscr{V}\subset\mathscr{C}$, a distinguished subset of elements $\mathscr{K}\subset\mathscr{C}$, and an operation $\vdash:\mathscr{C}\times\mathscr{C}\to\mathscr{C}$ such that 1. $\savestack{\tmpbox}{\stretchto{\scaleto{\scalerel*[\widthof{f\vdash g}]{\kern-% 0.6pt\bigwedge\kern-0.6pt}{\rule[-650.43pt]{4.3pt}{650.43pt}}}{}}{0.5ex}}% \stackon[1pt]{f\vdash g}{\tmpbox}=f,$ 2. $\overline{f\vdash g}=g.$ 3. $f\cdot(\bar{f}\vdash g)=\hat{f}\vdash g,$ unless $\bar{f}=g$, in which case $f\cdot(\bar{f}\vdash g)=f$, or unless $f\in\mathscr{K}$ or $\bar{f}\vdash g\in\mathscr{K}$. 4. $(f\vdash\hat{g})\cdot g=f\vdash\bar{g},$ unless $f=\hat{g}$, in which case $(f\vdash\hat{g})\cdot g=g$, 5. if $g\cdot f$ $\downarrow$, and $g,f\in\mathscr{V}$, then $g\cdot f\in\mathscr{V}$, 6. $f\vdash f\in\mathscr{V}$ for all $f\in\mathscr{C}$, 7. (witnesses) $u\in\mathscr{V}$ implies $\hat{u}\vdash\bar{u}\in\mathscr{V}$. 8. $\vdash$ is substitutive (Section 13.1) in both arguments. A functor $F:\mathscr{C}\to\mathscr{D}$ between generalized ideal categories is an ordinary functor (section 3) which preserves validity and $\vdash$: 1. $f\in\mathscr{V}_{\mathscr{C}}\text{ implies }F(f)\in\mathscr{V}_{\mathscr{D}},$ 2. $F(f\vdash g)=F(f)\vdash F(g)$. This defines a category ${\bf IdealCat}$.
Definition 48. A pointed profunctor is a structure $(P,\lx@sectionsign)$ consisting of a generalized category $P$ equipped with a distinguished object $\lx@sectionsign$ of $P$ satisfying: for all elements $f$ in $P$, $\operatorname{dom}(f)=\lx@sectionsign\text{ implies }f=\text{id}_{% \lx@sectionsign}.$
Definition 24. Let $\mathscr{C}$ be a generalized category. A $k$-cell in $\mathscr{C}$ is an element $f$ of $\mathscr{C}$ such that for every $k$-element sequence $\vec{s}$ of operations $\operatorname{{\bf s}}$ and $\operatorname{{\bf t}}$ that satisfy when applied to $f$, 1. $\operatorname{{\bf s}}^{k}f$ and $\operatorname{{\bf t}}^{k}$ are objects, and $\operatorname{{\bf s}}^{k-n}f$ and $\operatorname{{\bf t}}^{k-n}$ are not objects, for all $0\leq n\leq k$, 2. $\operatorname{{\bf s}}\operatorname{{\bf t}}f=\operatorname{{\bf s}}% \operatorname{{\bf s}}f$ and $\operatorname{{\bf t}}\operatorname{{\bf s}}f=\operatorname{{\bf t}}% \operatorname{{\bf t}}f$, 3. $\operatorname{{\bf s}}f$ and $\operatorname{{\bf t}}f$ is are $(k-1)$-cells. An element $f$ of a generalized category $\mathscr{C}$ is cellular if $f$ is a $k$-cell for some $k\geq 1$, and a generalized category $\mathscr{C}$ is cellular if every element of $\mathscr{C}$ is cellular.
Definition 38. Let $\mathscr{C}$ be an ideal cartesian closed category. We define the symbol $\mathbf{L}\mathscr{C}$ as follows: 1. The set of types of $\mathbf{L}\mathscr{C}$ is the set of symbols $A_{f}$ indexed by elements $f\in\mathscr{C}$: $\mathscr{T}_{\mathbf{L}\mathscr{C}}:=\{A_{f}\mid f\in\mathscr{C}\},$ in fact we set $A_{f}=f$ and take $\mathscr{C}$ itself as the set of types (this is needed for the proof of Theorem 15.4), however, we use the notation $A_{f}$ at times when it seems to lessen the potential for confusion. 2. The set of terms of $\mathbf{L}\mathscr{C}$ is the set of polynomials $\phi$ over $\mathscr{C}$ sourced at $\top$, that is, $\mathscr{S}_{\mathbf{L}\mathscr{C}}:=\{\phi\mid\phi\in\mathscr{C}[\vec{x}]% \text{ for some $\vec{x}$, }\hat{\phi}\text{ is in $\mathscr{C}$, and }\bar{% \phi}=\top\},$ where we assume that indeterminates have internal structure given by the syntax $()^{\cdot}$. 3. Define $\displaystyle\operatorname{ty}(\phi)$ $\displaystyle:=A_{\hat{\phi}},$ $\displaystyle s(A_{f})$ $\displaystyle:=A_{sf},$ $\displaystyle t(A_{f})$ $\displaystyle:=A_{tf},$ $\displaystyle A_{f}\cdot A_{g}$ $\displaystyle:=A_{f\cdot g},$ $\displaystyle A_{f}\wedge A_{g}$ $\displaystyle:=A_{f\wedge g},$ $\displaystyle A_{f}\vdash A_{g}$ $\displaystyle:=A_{f\vdash g},$ $\displaystyle\ulcorner A_{f}\urcorner$ $\displaystyle:=\ulcorner f\urcorner,\quad\text{ the name of $f$,}$ $\displaystyle\top_{\mathbf{L}\mathscr{C}}$ $\displaystyle:=\top_{\mathscr{C}}\vdash\top_{\mathscr{C}},$ $\displaystyle:=\top_{\mathscr{C}},$ $\displaystyle\mathscr{K}_{\mathbf{L}\mathscr{C}}$ is the set of constant polynomials. 4. if $\phi$ is a bulletin in $x$ over $\mathscr{C}$, then let $\phi^{\natural}:=A_{\epsilon_{x}\phi}.$ 5. $\mathscr{V}_{\mathbf{L}\mathscr{C}}$ is the set $\{A_{f}\mid f\in\mathscr{V}_{\mathscr{C}}\}$ joined with the set of valid constant terms, joined with the set of polynomials valid according to Definition 33. 6. Define $\displaystyle\top_{\mathbf{L}\mathscr{C}}$ $\displaystyle:=\top\vdash\top,$ ${}_{\mathbf{L}\mathscr{C}}$ $\displaystyle:=\top,$ Then we have a pre-generalized typed lambda calculus. We make from this a generalized typed lambda calculus by imposing the equality relation on terms inherited from equality in $\mathscr{C}(\vec{x})$: the equality relation $=_{\vec{x}}$ is defined to be equality in $\mathscr{C}(\vec{x})$, along with the usual inclusions of polynomial systems in one another.
Definition 1. A generalized category is a structure $(\mathscr{C},\sqsubseteq,\operatorname{{\bf s}},\operatorname{{\bf t}},\cdot)$ where $\mathscr{C}$ is a set, $\sqsubseteq$ is a relation on $\mathscr{C}$, $\operatorname{{\bf s}}$ and $\operatorname{{\bf t}}$ are mappings $\mathscr{C}\to\mathscr{C}$, and $(\cdot)$ is a partially defined mapping $\mathscr{C}\times\mathscr{C}\to\mathscr{C}$, denoted $a\cdot b$ or $ab$. These are required to satisfy 1. $(\mathscr{C},\sqsubseteq)$ is a partially ordered set, 2. $ab$ $\downarrow$ if and only if $\operatorname{{\bf s}}(a)\sqsubseteq\operatorname{{\bf t}}(b)$. 3. If $(ab)c$ $\downarrow$ or $a(bc)$ $\downarrow$ then $(ab)c=a(bc)$. 4. If $ab$ $\downarrow$ then $\operatorname{{\bf s}}(ab)=\operatorname{{\bf s}}(b)$ and $\operatorname{{\bf t}}(ab)=\operatorname{{\bf t}}(a)$. 5. (Element-Identity) For all $a\in\mathscr{C}$, there exists $b\in\mathscr{C}$ such that (a) $\operatorname{{\bf s}}(b)=\operatorname{{\bf t}}(b)=a$, (b) if $bc$ $\downarrow$ then $bc=c$, (c) if $cb$ $\downarrow$ then $cb=c$, 6. (Object-Identity) Let $a\in\mathscr{C}$ and $\operatorname{{\bf s}}(a)=\operatorname{{\bf t}}(a)=a$. Then (a) if $ba$ $\downarrow$ then $ba=b$. (b) If $ab$ $\downarrow$ then $ab=b$. 7. (Order Congruences1These axioms are needed for the Kleisli construction in Chapter \thechapter.) (a) If $a\sqsubseteq b$ then $\operatorname{{\bf s}}(a)\sqsubseteq\operatorname{{\bf s}}(b)$ and $\operatorname{{\bf t}}(a)\sqsubseteq\operatorname{{\bf t}}(b)$. (b) $a\sqsubseteq b$ and $c\sqsubseteq d$ and $ac,bd$ $\downarrow$ implies $ac\sqsubseteq bd.$ (c) $a\sqsubseteq b$ implies $1_{a}\sqsubseteq 1_{b}$. The element $c$ of axiom (5) is unique, and is denoted $1_{a}$ or $\text{id}_{a}$, and called the identity on $a$.
Definition 44. A morphism $F:\mathscr{E}\to\mathscr{E}^{\prime}$ of ideal elementary toposes is a functor [29] of ideal cartesian closed categories $F:\mathscr{E}\to\mathscr{E}^{\prime}$ such that such that $F(\Omega)=\Omega,$ $F(\operatorname{pred}(m))=\operatorname{pred}(F(m))$ for all monics $m$ in $\mathscr{E}$. This gives a category ${\bf idealTop}$ of elementary ideal toposes.
Definition 13. Generalized categories $\mathscr{C}$ and $\mathscr{C}^{\prime}$ are equivalent if their categories of invertibles are isomorphic.
Definition 3. A generalized category $\mathscr{C}$ is a category or one-category if the source and target of every nonidentity $f$ in $\mathscr{C}$ is an object in $\mathscr{C}$.
Definition 51. A bipartite generalized category $\mathscr{E}$ is maximal over its base if every construction of a pointed profunctor yields an element of $\mathscr{E}$, and if every construction of a pointed profunctor homomorphism also produces an element of $\mathscr{E}$.
Definition 34. Let $\mathscr{C}$ be an ideal cartesian closed category. Let $x$ be an indeterminate in $\mathscr{C}$. To define the symbol $\mathscr{C}(x),$ observe that $\mathscr{C}$ is equipped with the structure $(s,t,\cdot,\vdash,\mathscr{I},\mathscr{V})$ of a positive intuitionistic deductive system, when regarded as a generalized graph. Take $\mathscr{K}_{\mathscr{C}(x)}$ to be the set of constant polynomials.3This definition restricts behavior of terminal arrows $\phi\vdash\psi$ for polynomials $\phi$ and $\psi$, but it will not make a difference for our purposes. Now take the polynomial system $\mathscr{C}[x]$ of Definition 33, and then take the smallest equivalence relation $=_{x}$ of paths in $\mathscr{C}[x]$ satisfying the conditions: 1. If $f=g$ in $\mathscr{C}$, then $f=_{x}g$ in $\mathscr{C}(x)$, 2. $(\phi\vdash\hat{\psi})\cdot\psi=_{x}(\phi\vdash\bar{\phi})$ unless $\phi=_{x}\bar{\psi}$, in which case $(\phi\vdash\hat{\psi})\cdot\psi=\psi$, 3. $\psi\cdot(\bar{\psi}\vdash\phi)=_{x}(\hat{\psi}\vdash\phi)$ unless $\phi=_{x}\hat{\psi}$, in which case $\psi\cdot(\bar{\psi}\vdash\phi)=_{x}(\hat{\psi}\vdash\phi),$ unless $\psi\in\mathscr{K}$ or $\bar{\psi}\vdash\phi\in\mathscr{K}$, 4. For all $\phi,\psi\in\mathscr{C}[x]$, if $(\chi\cdot\psi)\cdot\phi$ is defined, then $(\chi\cdot\psi)\cdot\phi=_{x}\chi\cdot(\psi\cdot\phi),$ 5. Composition $(\cdot)$, combination $\langle,\rangle$, and the turnstile $(\vdash)$ in $\mathscr{C}(x)$ is substitutive in both arguments: (a) if $\phi=_{x}\psi$ then $\phi\vdash\chi=_{x}\psi\vdash\chi$ and $\chi\vdash\phi=_{x}\chi\vdash\psi$, (b) if $\phi=_{x}\psi$ and $\phi\cdot\chi$ $\downarrow$ then $\phi\cdot\chi=_{x}\psi\cdot\chi$ and if $\chi^{\prime}\cdot\phi$ $\downarrow$ then $\chi^{\prime}\cdot\phi=_{x}\chi^{\prime}\cdot\psi$, (c) if $\phi=_{x}\psi$ and $\langle\phi,\chi\rangle$ $\downarrow$ then $\langle\phi,\chi\rangle=_{x}\langle\psi,\chi\rangle$ and $\langle\chi,\phi\rangle=_{x}\langle\chi,\psi\rangle$, 6. For all $\phi:a\to\top$, $f=_{x}a\vdash\top$, 7. For all pairs $(a,b)\in\mathscr{C}$ (viewed as a deductive system), if the unique good pair for $(a,b)$ is $(\pi_{a,b},\pi^{\prime}_{a,b})$ and any good evaluation $\epsilon_{a,b}$ is taken, then these are required to satisfy their usual equational properties in expressions involving $x$: (a) if $\pi_{a,b}\langle\phi,\psi\rangle$ $\downarrow$ then $\pi_{a,b}\langle\phi,\psi\rangle=_{x}\phi$, (b) if $\pi^{\prime}_{a,b}\langle\phi,\psi\rangle$ $\downarrow$ then $\pi^{\prime}_{a,b}\langle\phi,\psi\rangle=_{x}\psi$, (c) if $\langle\pi_{a,b}\cdot\phi,\pi^{\prime}_{a,b}\cdot\phi\rangle$ $\downarrow$ then $\langle\pi_{a,b}\cdot\phi,\pi^{\prime}_{a,b}\cdot\phi\rangle=_{x}\phi$, (d) if $\langle\phi\cdot\pi_{a,b},\psi\cdot\pi^{\prime}_{a,b}\rangle$ $\downarrow$ then $\langle\phi\cdot\pi_{a,b},\psi\cdot\pi^{\prime}_{a,b}\rangle=\phi\wedge\psi$, (e) if $\epsilon\langle\phi^{*}\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle$ $\downarrow$ then $\epsilon\langle\phi^{*}\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle=\phi$, (f) if $(\epsilon\langle\phi\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle)^{*}$ $\downarrow$ then $(\epsilon\langle\phi\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle)^{*}=\phi$.
Definition 7. A subcategory of a generalized category $\mathscr{C}$ is a subset $\mathscr{C}^{\prime}$ of $\mathscr{C}$ whose order is inherited from $\mathscr{C}$ closed under source, target, composition, and identities: if $a\in\mathscr{C}^{\prime}$, then $1_{a}\in\mathscr{C}^{\prime}$. A subcategory $\mathscr{C}^{\prime}$ is full if $a,b\in\mathscr{C}^{\prime}$ implies $\hom(a,b)$ is contained in $\mathscr{C}^{\prime}$.
Definition 20. Let $\mathscr{C},\mathscr{C}^{\prime}$ be generalized categories. A functor up to objects from $\mathscr{C}$ to $\mathscr{C}^{\prime}$ is a map $F:\mathscr{C}\to\mathscr{C}^{\prime}$ satisfying, for every $a,b\in\mathscr{C}$, 1. $F(ab)=F(a)(b)$, 2. $F(a)$ is an identity in $\mathscr{C}^{\prime}$ if and only if $a$ is an identity in $\mathscr{C}$, 3. $F(\operatorname{{\bf s}}(a))=\operatorname{{\bf s}}(F(a))$ unless $a$ is an object of $\mathscr{C}$, 4. $F(\operatorname{{\bf t}}(a))=\operatorname{{\bf t}}(F(a))$ unless $a$ is an object of $\mathscr{C}$.
Definition 42. A subobject classifier for a generalized category $\mathscr{E}$ is a pair $({\bf t},\Omega)$ where $\Omega$ is an object in $\mathscr{E}$ and where ${\bf t}:\top\rightarrowtail\Omega$ is in $\mathscr{E}$, such that for every monic $m:a\rightarrowtail b$ in $\mathscr{E}$, there is a unique arrow $p:b\to\Omega$ such that the following square is a pullback: $\tikzcd a\arrow[tail]{d}[swap]{m}\arrow{r}{ter}&\top\arrow[tail]{d}{{\bf t}}\\ b\arrow{r}[swap]{p}&\Omega$
Definition 15. Let $\mathscr{C},\mathscr{C}^{\prime}$ be generalized categories, let $F,G:\mathscr{C}\to\mathscr{C}^{\prime}$ be two functors. We say that a morphism of functors [15] from $F$ to $G$ is a pair $(\theta_{1},\theta_{2})$ of maps $\mathscr{C}\to\mathscr{C}^{\prime}$ satisfying, for all $a\in\mathscr{C}$, $\theta_{1}(a)F(a)=G(a)\theta_{2}(a)\,\downarrow$ Note that here, $\theta_{1}$ and $\theta_{2}$ are no longer presumed to be invertible. We may write the morphism of functors with the notation $(\theta_{1},\theta_{2}):F\Rightarrow G$.
Definition 29. A generalized typed deductive system or simply a generalized deductive system is a structure $(\mathscr{A},s,t,\cdot,\vdash,\mathscr{V}),$ where $(\mathscr{A},s,t)$ is a generalized graph, ($\cdot$) is a partially-defined operation $\mathscr{A}\times\mathscr{A}\to\mathscr{A}$ on $\mathscr{A}$, $(\vdash)$ is an operation $\mathscr{A}\times\mathscr{A}\to\mathscr{A}$, and $\mathscr{V}$ is a subset of $\mathscr{A}$, satisfying 1. for all $a,b\in\mathscr{A}$, $b\cdot a\text{ is defined iff }ta=sb$ 2. $s(ab)=s(b)$ and $t(ab)=t(a)$ 3. $s(a\vdash b)=a$ and $t(a\vdash b)=b$. 4. for every $a\in\mathscr{A}$, $a\vdash a\in\mathscr{V}$. 5. if $a,b\in\mathscr{V}$, and $a\cdot b$ $\downarrow$, then $a\cdot b\in\mathscr{V}$. 6. for every $a,b\in\mathscr{A}$, if there exists $u\in\mathscr{V}$ with $\bar{u}=a$ and $\hat{u}=b$, then $a\vdash b\in\mathscr{V}$. A morphism of generalized typed deductive systems $\phi:\mathscr{A}\to\mathscr{B}$ is a morphism of generalized graphs satisfying 1. $\phi(a\cdot b)=\phi(a)\cdot\phi(b),$ 2. $\phi(a\vdash b)=\phi(a)\vdash\phi(b),$ 3. if $a\in\mathscr{V}$, then $\phi(a)\in\mathscr{V}$. This gives a category ${\bf DedSys}$ of generalized (typed) deductive systems.
Definition 52. An ideal maximal bipartite generalized category $\mathscr{E}$ is a bipartite category that satisfies: 1. $\mathscr{E}$ has the maximality property of Definition 51, 2. For every $P$ in the upper region of $\mathscr{E}$ and for every $U$ in the base of $\mathscr{E}$, there is a section $s_{U}:U\to P$ that has the property that for all $f,g\in\mathscr{E}$ that are not identities, if $s\cdot f$ $\downarrow$ then $s_{U}\cdot f=s_{\bar{f}}$, and if $g\cdot s$ $\downarrow$ then $g\cdot s=s_{U}$.
Definition 36. A generalized typed lambda calculus is a pre-generalized typed lambda calculus on which there is an equality relation on the terms $\mathscr{S}_{\Lambda}$ of $\Lambda$ defined as follows: Let $\mathscr{P}$ be the finite power set $\mathscr{P}_{fi}(\mathscr{X})$ of $\mathscr{X}$. For each finite set $\bar{x}=\{x_{1},\dots,x_{n}\}$ in $\mathscr{P}$, let $\mathscr{R}(\Lambda,\bar{x}):=\{s\in\mathscr{S}_{\Lambda}\mid\operatorname{FV}% (s)\subset\bar{x}\}.$ We define the relation $=_{\bar{x}}$ on $\mathscr{R}(\Lambda,\bar{x})$ to be the smallest equivalence relation that satisfies 1. $=_{\bar{x}}$ is reflexive, symmetric, and transitive, 2. Substitutivity conditions: (a) if $s=_{\bar{x}}t$, and $\pi(s)$ $\downarrow$, then $\pi(s)=_{\bar{x}}\pi(t)$, and $\pi^{\prime}(s)=_{\bar{x}}\pi^{\prime}(t)$, (b) if $s=_{\bar{x}}t$, then $s\wr r=_{\bar{x}}t\wr r$ and $u\wr s=_{\bar{x}}u\wr t$ whenever these expressions are well-defined, (c) if $s=_{\bar{x}}t$, and $\langle s,r\rangle$ $\downarrow$, then $\langle s,r\rangle=_{\bar{x}}\langle t,r\rangle$, and similarly in the second argument, (d) if $s=_{\bar{x}}t$, then $s\wr r=_{\bar{x}}t\wr r$ and $u\wr s=_{\bar{x}}u\wr t$ whenever these expressions are well-defined, 3. for all $s:\top$, $s=_{\bar{x}}*$, 4. for all $a:A,b:B,$ $\pi(\langle a,b\rangle)=_{\bar{x}}a,$ $\pi^{\prime}(\langle a,b\rangle)=_{\bar{x}}b,$ 5. for all $c:A\wedge B$, $\langle\pi(c),\pi^{\prime}(c)\rangle=_{\bar{x}}c,$ 6. For all terms $s\in\mathscr{S}_{\Lambda}$, terms $a\in\mathscr{S}_{\Lambda}$, and variable $x$ that may appear in $\bar{x}$, (a) $(\lambda(x,s))\wr a=_{\bar{x}}s[x/a],$ (b) $\lambda(x,s\wr x)=_{\bar{x}}s$, (c) if $\operatorname{FV}(s)=\{x\}$, there exists a unique $A\in\mathscr{T}_{\Lambda}$ such that $s=_{\{x\}}\ulcorner A\urcorner\wr x$. (d) ($\alpha$-conversion for lambda terms) $\lambda(y,s)=_{\bar{x}}\lambda(y^{\prime},s[y/y^{\prime}])$ if $\operatorname{ty}(y)=\operatorname{ty}(y^{\prime})$ and $y^{\prime}\notin\operatorname{FV}(s)$. We observe that $\operatorname{FV}()$ is still well-defined. We denote by $s^{\natural}$ the type $A$ given by Axiom 6c. We impose the condition on the $=_{\bar{x}}$’s that: 1. if $\bar{x}\subset\bar{y}$ then for all $s,t\in\mathscr{R}(\Lambda,\bar{y})$, $s=_{\bar{x}}t$ implies $s=_{\bar{y}}t$. Because (1) $s=_{\operatorname{FV}s}s$, and (2) if $s=_{\bar{x}}t$ and $s=_{\bar{y}}t$, then there exists a finite set $\bar{z}$ such that $s=_{\bar{z}}t$ and $\bar{x},\bar{y}\subset\bar{z}$, we may define an equivalence relation equality in $\mathscr{S}_{\Lambda}$ on the set $\mathscr{S}_{\Lambda}$ of terms of $\Lambda$ by $s=t\,\,\,\text{ if }\,\,s=_{\bar{x}}t\text{ for some $\bar{x}$ in $\mathscr{P}% $}.$ A morphism $\Phi:\Lambda\to\text{M}$ of generalized typed lambda calculi, also called a translation, is a mapping $\Phi:\Lambda\to\text{M}$ that satisfies the following, where equalities between terms are interpreted as equality in $\mathscr{S}_{\Lambda}$: 1. for all $A\in\mathscr{T}_{\Lambda},s\in\mathscr{S}_{\Lambda}$, $\Phi(A)\in\mathscr{T}_{\text{M}}$ and $\Phi(s)\in\mathscr{S}_{\text{M}},$ 2. the restriction of $\Phi$ to $\mathscr{T}_{\Lambda}$ is a morphism of ideal categories that satisfies $\Phi(\top_{\Lambda})=\top_{\text{M}},$ $\Phi(A\wedge B)=\Phi(A)\wedge\Phi(B),$ 3. if $s=_{\bar{x}}t$, then $\Phi(s)=_{\Phi(\bar{x})}\Phi(t)$. 4. $\Phi(\operatorname{ty}(s))=\operatorname{ty}(\Phi(s)),$ 5. $\Phi(\ulcorner A\urcorner)=\ulcorner\Phi(A)\urcorner,$ 6. $\Phi(*)=*$, 7. for all $\alpha\in\Lambda$, $\Phi(\alpha^{\cdot})=\Phi(\alpha)^{\cdot},$ 8. $\Phi(\pi(c))=\pi(\Phi(c),$ and $\Phi(\pi^{\prime}(c))=\pi^{\prime}(\Phi(c)),$ 9. $\Phi(s\wr t)=\Phi(s)\wr\Phi(t),$ 10. $\Phi(\langle s,t\rangle)=\langle\Phi(s),\Phi(t)\rangle,$ 11. $\Phi(\lambda(x,s))=\lambda(\Phi(x),\Phi(s)).$ As a consequence of (3), $\Phi$ preserves equalities in $\Lambda$: $s=t\text{ implies }\Phi(s)=\Phi(t).$ This gives a category $\text{$\lambda$-}{\bf Calc}$ of generalized typed lambda calculi.
Definition 8. Two generalized categories $\mathscr{C}$ and $\mathscr{C}^{\prime}$ are isomorphic if there is an invertible functor (i.e., invertible as a mapping) $F$ from $\mathscr{C}$ to $\mathscr{C}^{\prime}$.
Definition 46. Let $\mathscr{E}$ be an ideal elementary topos. A Lawvere-Tierney topology, or topology on $\mathscr{E}$ is a choice of element $j\in\mathscr{E}$ such that (0) $j:\Omega\to\Omega$, (1) $j\cdot{\bf t}={\bf t}$, (2) $j\cdot j=j$, (3) $j\cdot\delta_{{\bf t}}=\delta_{{\bf t}}\cdot(j\wedge j).$ A monic $m$ is dense with respect to $j$ if $[m]=\operatorname{subob}(j\cdot\operatorname{pred}(m)),$ where $[m]$ is the subobject defined by $m$ and $\operatorname{subob}(\phi)$ is the subobject defined by a predicate $\phi$. Dense subobjects are defined similarly.
Definition 22. Let $\mathscr{C},I$ be generalized categories. Let $\alpha:I\to\mathscr{C}$ be a functor, possibly only a functor up to objects. A cone is said to be over (or below) the base $\alpha$ if 1. $\widehat{\pi(i)}=\alpha(i)$, for all $i\in I$, 2. for all $i\in I$, $\pi(\hat{i})=\alpha(i)\pi(\bar{i})$. A limit of $\alpha$ is a cone $\pi:I\to\mathscr{C}$ below the base $\alpha$ such that for any cone $\tilde{\pi}:I\to\mathscr{C}$ over the same base $\alpha$, there is a unique $\lambda\in\mathscr{C}$ such that $\tilde{\pi}=\pi\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}\lambda$. (Here, $\pi\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}\lambda$ is the map defined by $(\pi\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}\lambda)(i)=\pi(i% )\cdot\lambda.$) Dually, a cocone is said to be over (or below) the base $\alpha$ if 1. $\overline{\pi(i)}=\alpha(i)$, for all $i\in I$, 2. for all $i\in I$, $\pi(\bar{i})=\pi(\hat{i})\alpha(i)$. A colimit of $\alpha$ is a cocone $\pi:I\to\mathscr{C}$ such that for any cone $\tilde{\pi}:I\to\mathscr{C}$ over the base $\alpha$, there is a unique $\lambda\in\mathscr{C}$ such that $\tilde{\pi}=\lambda\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}\pi$. Here, $\lambda\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}\pi$ is the map defined by $(\lambda\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}\pi)(i)=% \lambda\cdot\pi(i)$, as before.
Definition 40. Let $\Lambda$ be a generalized typed lambda calculus, and let $x\in\mathscr{X}_{\Lambda}$ be a variable. We define the symbol $\Lambda_{x}$ to be the generalized typed lambda calculus is defined exactly as $\Lambda$, except that $\mathscr{V}_{\Lambda_{x}}:=\{x\}\cup\mathscr{V},$ that is, $x$ is taken to be a validating term in $\Lambda_{x}$.
Definition 18. Let $\mathscr{C}$ and $\mathscr{D}$ be generalized categories. An adjunction $(F,G,\eta,\varepsilon)$ is a pair of functors $\tikzcd\mathscr{C}\arrow[r,"F",shiftleft]\arrow[r,leftarrow,shiftright,"G"% below]&\mathscr{D}\\ \vspace{-3.5ex}$ together with natural transformations $\eta:\text{id}_{\mathscr{C}}\to G\mathbin{\circ}F,\quad\varepsilon:F\mathbin{% \circ}G\to\text{id}_{\mathscr{D}},$ satisfying the identities $\displaystyle(G\mathbin{\circ}\varepsilon)\mathbin{\raisebox{0.86pt}{$% \scriptscriptstyle{\Delta}$}}(\eta\mathbin{\circ}G)$ $\displaystyle=1_{G},$ $\displaystyle(\varepsilon\mathbin{\circ}F)\mathbin{\raisebox{0.86pt}{$% \scriptscriptstyle{\Delta}$}}(F\mathbin{\circ}\eta)$ $\displaystyle=1_{F},$ where $1_{F}$ is the mapping $f\mapsto 1_{F(f)}$. Given an adjunction $(F,G,\eta,\varepsilon)$, $\eta$ is called the unit and $\varepsilon$ is called the counit of the adjunction. A natural equivalence $(\theta,\theta^{\prime})$ is an adjoint equivalence if $\theta$ and $\theta^{\prime}$ are the unit and counit of an adjunction.
Definition 56. A topology on $\mathscr{C}$ is a collection $J$ of subsets in $\mathscr{C}$, satisfying: 1. Every $\mathscr{S}$ in $J$ is a sieve in $\mathscr{C}$. 2. For every $U\in\mathscr{C}$, the maximal sieve at $U$ is in $J$. 3. If $\mathscr{S}$ is in $J$ and $\rho\in\mathscr{C}$ with $\hat{\rho}=\bar{\mathscr{S}}$, then ${\mathscr{S}}|_{\rho}$ is in $J$. 4. If $\mathscr{S}$ is in $J$ and $\mathscr{R}$ is any sieve satisfying $\bar{\mathscr{R}}=\bar{\mathscr{S}}$, and if for every $f\in\mathscr{S}$, ${f}|_{\mathscr{R}}$ is in $J$, then $\mathscr{R}$ is in $J$. Elements of the subcollection of $J$ consisting of sieves at $U\in\mathscr{C}$ are called the sieves that cover $U$ or covering sieves for $U$. A generalized category $\mathscr{C}$ equipped with a topology $J$, denoted $\mathscr{C}$ or $(\mathscr{C},J)$, is a site.
Definition 33. Let $\mathscr{A}$ be a positive intuitionistic deductive system. Let $x$ be an indeterminate with target $\hat{x}$ in $\mathscr{A}$. We write $\mathscr{A}[x]$ for the positive intuitionistic deduction system freely generated on the set $\mathscr{A}\cup\{x\}$. This means that 1. Operations on $\mathscr{A}$ of Definition 30 are extended from $\mathscr{A}$ to $\mathscr{A}[x]$ by free generation on expressions $\phi$ containing any instance of $x$: $\phi::=f\,\mid\,x\,\mid\,\phi\vdash\phi\,\mid\,\phi\wedge\phi\,\mid\,\langle% \phi,\phi\rangle\,\mid\,\phi^{*}$ where $f$ can be any element of $\mathscr{A}$, and $x$ is any indeterminate. Expressions so generated that do not contain any instance of $x$ are thrown out, and the set of all elements of $\mathscr{A}$ is then added back in. 2. The valid elements of $\mathscr{A}[x]$ are $x$, those of $\mathscr{A}$, and those generated from $x$ and those of $\mathscr{A}$ using the validities of Definition 30. There is an obvious embedding of $\mathscr{A}$ in $\mathscr{A}[x]$, via which we will usually view $\mathscr{A}$ as a subset of $\mathscr{A}[x]$.
Definition 49. A morphism of pointed profunctors $P$ and $Q$ is a functor $\phi:P\to Q$ satisfying: 1. $\phi(\lx@sectionsign_{P})=\lx@sectionsign_{Q},$ 2. for all elements $U\in\mathscr{C}$, $\phi(U)=\lx@sectionsign\text{ implies }U=\lx@sectionsign.$ If the induced map between base categories is the identity, then $F$ is said to be base-preserving.
Definition 26 (Kleisli Construction). If $\mathscr{C}$ is a generalized category, and $T=(T,\eta,\mu)$ is a monad on $\mathscr{C}$, set $\mathscr{C}_{T}:=\{(y,f)\mid T(y)=\hat{f},\,(\star)\,\}$ where $(\star)$ is a condition (detailed in the proof) that may be safely ignored on a first reading, and $\begin{cases}\,\overline{(y,f)}=(\hat{\bar{f}},\eta(\hat{\bar{f}})\bar{f}),&\\ \,\widehat{(y,f)}=(\hat{y},\eta(\hat{y})\cdot y),&\\ \,(z,g)\cdot(y,f)=(z,\mu(z)\cdot T(g)\cdot f),\hskip 20.0pt\text{ if }\bar{g}% \sqsubseteq y.&\\ \end{cases}$
Definition 11. An element $m$ of a generalized category $\mathscr{C}$ is monic if $mf,mg\downarrow$ and $mf=mg$ implies $f=g$. An element $e$ in $\mathscr{C}$ is epi if $fe,ge\downarrow$ and $fe=ge$ implies $f=g$. We say $a$ is isomorphic to $b$, denoted $a\cong b,$ if there exists an invertible element $\theta$ with $\bar{\theta}=a,\hat{\theta}=b$.
Definition 41. An ideal elementary topos is an ideal cartesian closed category with 1. all finite limits and colimits, 2. a subobject classifier.
Definition 10. For $a,b\in\mathscr{C},$ we have the following equivalence relations: 1. $a$ and $b$ are in the same monic class, or subobject, $a\sim_{m}b$, if there exists invertible element $\theta\in\mathscr{C}$ such that $a\theta=b$. 2. $a$ and $b$ are in the same epic class, or quotient, $a\sim_{e}b$, if there exists invertible element $\theta\in\mathscr{C}$ such that $\theta a=b$; 3. $a$ and $b$ are in the same iso class, $a\sim b$, if there exist invertible elements $\theta_{1},\theta_{2}\in\mathscr{C}$ such that $\theta_{1}a=b\theta_{2}$.
Definition 25. Let $\mathscr{C}$ be a generalized category. A monad on $\mathscr{C}$ is a structure $(T,\eta,\mu)$, where $T:\mathscr{C}\to\mathscr{C}$ is a functor, and $\eta$ and $\mu$ are (order-preserving) natural transformations $\text{id}_{\mathscr{C}}\to T$ and $T^{2}\to T$, respectively, such that the following hold: 1. $\mu\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}(T\mathbin{\circ}% \mu)=\mu\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}(\mu\mathbin{% \circ}T)$ 2. $\mu\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}(T\mathbin{\circ}% \eta)=\mu\mathbin{\raisebox{0.86pt}{$\scriptscriptstyle{\Delta}$}}(\eta% \mathbin{\circ}T)=1_{T}$, where $1_{T}$ denotes the mapping $f\mapsto 1_{T(f)}$. A monad is said to satisfy the monic condition [24] if for all $x,y$ in $\mathscr{C}$, $\eta(\hat{x})x\sqsubseteq\eta(\hat{y})y\text{ implies }x\sqsubseteq y.$ It follows that $\eta(x)$ is a monic for all $x\in\mathscr{C}$.
Definition 5. A mapping $\mathscr{C}\to\mathscr{C}^{\prime}$ between generalized categories is functorial or a functor if 1. $a\sqsubseteq b\text{ implies }F(a)\sqsubseteq F(b),$ 2. $F(\bar{a})=\overline{F(a)},$ 3. $F(\hat{a})=\widehat{F(a)},$ 4. $F(ab)=F(a)F(b),\text{ if }ab\,\downarrow,$ 5. $F(1_{a})=1_{F(a)}.$ We thus have a category ${\bf GenCat}$ of generalized categories and functors.
Definition 32. An ideal cartesian closed category is a ideal category with identities $\mathscr{C}$ that is equipped with a structure $(\top,\wedge,\langle,\rangle,()^{*})$ where 1. $\top$ is a distinguished valid element in $\mathscr{C}$, 2. $\wedge$ is an operation $\mathscr{C}\times\mathscr{C}\to\mathscr{C}$, 3. $\langle,\rangle$ is a partially defined operation $\mathscr{C}\times\mathscr{C}\to\mathscr{C}$ 4. $()^{*}$ is a partially defined operation $\mathscr{C}\to\mathscr{C}$ which satisfies the conditions: 1. $\top\in\mathscr{K}$, and $\mathscr{K}$ is closed under $\wedge,\langle,\rangle,$ and $()^{*}$, 2. the structure $(s,t,\mathscr{V},\vdash,\cdot,\top,\wedge,\langle,\rangle,()^{*})$ defines a positive intuitionistic deductive system on $\mathscr{C}$. 3. for all $a\in\mathscr{C}$, if $f:a\to\top$ then $f=(a\vdash\top)$. 4. For every pair $(a,b)$ of subjects of $\mathscr{C}$, there exists a good pair $(\pi,\pi^{\prime})$ for $(a,b)$. 5. For every good pair $(\pi,\pi^{\prime})$ for any pair of subjects $(a,b)$, there is a good evaluation $\epsilon=\epsilon_{\pi,\pi^{\prime}}$ for $(\pi,\pi^{\prime})$. Here, if $(a,b)$ is a pair of subjects of $\mathscr{C}$, then a pair $(\pi,\pi^{\prime})$ of elements of $\mathscr{C}$ are a good pair for $(a,b)$ if 1. $\pi$ and $\pi^{\prime}$ are valid, 2. $\pi:a\wedge b\to a$, and $\pi^{\prime}:a\wedge b\to b$, 3. if $\pi\langle f,g\rangle$ $\downarrow$ then $\pi\langle f,g\rangle=f,$ 4. if $\pi^{\prime}\langle f,g\rangle$ $\downarrow$ then $\pi^{\prime}\langle f,g\rangle=g,$ 5. if $\langle\pi f,\pi^{\prime}f\rangle$ $\downarrow$ then $\langle\pi f,\pi^{\prime}f\rangle=f$, 6. if $f\cdot\pi$ and $g\cdot\pi^{\prime}$ $\downarrow$, then $\langle f\cdot\pi,g\cdot\pi^{\prime}\rangle=f\wedge g$. and a good evaluation for a good pair $(\pi,\pi^{\prime})$ for a pair of subjects $(a,b)$ is an element $\epsilon=\epsilon_{\pi,\pi^{\prime}}$ of $\mathscr{C}$ that satisfies, for every $c\in\mathscr{C}$ and every good pair $(\pi_{c,a},\pi^{\prime}_{c,a})$ for $(c,a)$, 1. $\epsilon$ is valid, 2. $\epsilon:(a\vdash b)\wedge a\to b$, 3. if $\epsilon\cdot\langle f^{*}\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle$ $\downarrow$ then $\epsilon\cdot\langle f^{*}\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle=f,$ 4. if $(\epsilon\cdot\langle f\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle)^{*}$ $\downarrow$ then $(\epsilon\cdot\langle f\cdot\pi_{c,a},\pi^{\prime}_{c,a}\rangle)^{*}=f$. A morphism $F:\mathscr{C}\to\mathscr{D}$ between ideal cartesian closed categories $\mathscr{C}$ and $\mathscr{D}$ is a functor of ideal categories satisfying 1. $F(\top)=\top$, 2. $F(a\wedge b)=F(a)\wedge F(b),$ 3. $F(\langle a,b\rangle)=\langle F(a),F(b)\rangle,$ 4. $F$ sends a good pair in $\mathscr{C}$ to a good pair in $\mathscr{D}$. Thus we have a category ${\bf ICCC}$ of ideal cartesian closed categories.
Definition 55. A subpointed profunctor $P^{\prime}$ of a pointed profunctor $P$ on a generalized category $\mathscr{C}$ is a generalized category of $P$ with the same section object $\lx@sectionsign$ and the same base generalized category $\mathscr{C}$.
Definition 17. Two generalized categories $\mathscr{C}$ and $\mathscr{C}^{\prime}$ are naturally equivalent if they are equivalent via natural transformations $\theta:F\mathbin{\circ}G\cong\text{id}_{\mathscr{C}^{\prime}},$ $\theta^{\prime}:G\mathbin{\circ}F\cong\text{id}_{\mathscr{C}}.$
Definition 35. A pre-generalized typed lambda calculus is a structure $(\Lambda,\mathscr{T}_{\Lambda},\mathscr{S}_{\Lambda},s,t,\cdot,\vdash,\top,% \wedge,\operatorname{ty},\ulcorner\urcorner,*,()^{\cdot},\pi,\pi^{\prime},\wr,% \langle,\rangle,\lambda,\mathscr{V}_{\Lambda})$ where 1. $\Lambda$ is a set, 2. $\mathscr{T}_{\Lambda}$ and $\mathscr{S}_{\Lambda}$ are disjoint subsets of $\Lambda$ and $\mathscr{T}_{\Lambda}\cup\mathscr{S}_{\Lambda}=\Lambda$, 3. $\mathscr{V}_{\Lambda}$ is a subset of $\Lambda$, 4. the system $(\mathscr{T}_{\Lambda},s,t,\cdot,\vdash,\mathscr{V}^{\prime})$ is an ideal category, where $\mathscr{V}^{\prime}=\mathscr{V}_{\Lambda}\cap\mathscr{T}_{\Lambda}$, 5. $\top$ is a designated element of $\mathscr{T}_{\Lambda}$, 6. $\wedge$ is a mapping $\mathscr{T}_{\Lambda}\times\mathscr{T}_{\Lambda}\to\mathscr{T}_{\Lambda}$, 7. $\ulcorner\urcorner$ is a mapping $\mathscr{T}_{\Lambda}\to\mathscr{S}_{\Lambda}$, 8. $\operatorname{ty}$ is a mapping $\mathscr{S}_{\Lambda}\to\mathscr{T}_{\Lambda}$, 9. and in $\mathscr{S}_{\Lambda}$: (a) $*$ is a designated element of $\mathscr{S}_{\Lambda}$, (b) $()^{\cdot}$ is a mapping $\Lambda\to\mathscr{S}_{\Lambda}$, (c) $\pi$, $\pi^{\prime}$ are partially defined mappings $\mathscr{S}_{\Lambda}\to\mathscr{S}_{\Lambda}$, (d) $\wr$ and $\langle,\rangle$ are partially defined mappings $\mathscr{S}_{\Lambda}\times\mathscr{S}_{\Lambda}\to\mathscr{S}_{\Lambda}$, (e) $\lambda$ is a mapping $\mathscr{X}\times\mathscr{S}\to\mathscr{S}$, where $\mathscr{X}$ is defined below, subject to the conditions 1. $\hat{\top}=\bar{\top}=\top,$ 2. for all $s\in\mathscr{S}_{\Lambda}$, $\pi(s)$ $\downarrow$ iff $\pi^{\prime}(s)$ $\downarrow$ iff there exist $A,B\in\mathscr{T}_{\Lambda}$ such that $\operatorname{ty}(s)=A\wedge B$, 3. $s\wr t$ $\downarrow$ iff there exist $A,B\in\mathscr{T}_{\Lambda}$ such that $\operatorname{ty}(s)=A\vdash B$ and $\operatorname{ty}(t)=A$, 4. $\langle s,t\rangle$ $\downarrow$ iff $\operatorname{ty}(s)=\operatorname{ty}(t)$, typing conditions 1. $\operatorname{ty}(\ulcorner A\urcorner)=\bar{A}\vdash\hat{A}$, 2. $\operatorname{ty}(*)=\top$, 3. for all $\alpha\in\Lambda$, $\operatorname{ty}(\alpha^{\cdot})=\operatorname{ty}(\alpha),$ 4. if $s\in\mathscr{S}_{\Lambda}$ and $\operatorname{ty}(s)=A\wedge B$, then $\operatorname{ty}(\pi(s))=A$ and $\operatorname{ty}(\pi^{\prime}(s))=B$, 5. if $s\wr t$ $\downarrow$, then $\operatorname{ty}(s\wr t)=\widehat{\operatorname{ty}(s)}$, 6. if $\langle s,t\rangle$ $\downarrow$, then $\operatorname{ty}(\langle s,t\rangle)=\operatorname{ty}(s)\wedge\operatorname{% ty}(t)$, 7. if $\lambda(x,s)$ $\downarrow$, then $\operatorname{ty}(\lambda(x,s))=\operatorname{ty}(x)\vdash\operatorname{ty}(s)$, and the validities 1. $*\in\mathscr{V}_{\Lambda}$, 2. if $A,B\in\mathscr{V}_{\Lambda}$, then $A\wedge B\in\mathscr{V}_{\Lambda}$, 3. (witnesses, propositions-as-types) if $s\in\mathscr{V}_{\Lambda}$, then $\operatorname{ty}(s)\in\mathscr{V}_{\Lambda}$, 4. If $A\in\mathscr{V}_{\Lambda}$, then $\ulcorner A\urcorner\in\mathscr{V}_{\Lambda}$. 5. $*\in\mathscr{V}_{\Lambda}$, 6. if $c\in\mathscr{V}_{\Lambda}$ and $\pi(c),\pi^{\prime}(c)$ $\downarrow$, then $\pi(c),\pi^{\prime}(c)\in\mathscr{V}_{\Lambda}$, 7. if $a,f\in\mathscr{V}$, then $f\wr a\in\mathscr{V}$, 8. $a,b\in\mathscr{V}_{\Lambda}$ implies $\langle a,b\rangle\in\mathscr{V}_{\Lambda}$, 9. if $s\in\mathscr{V}_{\Lambda}$, then $\lambda(x,s)\in\mathscr{V}_{\Lambda}$.
Definition 14. A functor $F:\mathscr{C}\to\mathscr{C}^{\prime}$ is essentially injective if it satisfies one of the following equivalent conditions, 1. $\tilde{F}$ is injective. 2. For $a,b\in\mathscr{C}$, $F(a)=F(b)$ implies $a\sim b$. and $F$ is essentially surjective if it satisfies one of the following equivalent conditions: 1. $\tilde{F}$ is surjective. 2. For $\alpha\in\mathscr{C}^{\prime}$, there exists $a\in\mathscr{C}$ with $F(a)\sim\alpha$.
Definition 6. The sets $\hom(a,b)=\{c\in\mathscr{C}\mid\bar{c}=a,\hat{c}=b\},$ for $a,b\in\mathscr{C}$, are called the hom sets of $\mathscr{C}$.
Definition 28. A generalized graph is a triple $(\mathscr{A},s,t)$, where $\mathscr{A}$ is a set, $s,t$ are maps $\mathscr{A}\to\mathscr{A}$. A morphism $\Phi:\mathscr{A}\to\mathscr{B}$ of generalized graphs is a mapping $\Phi$ from $\mathscr{A}$ to $\mathscr{B}$ such that 1. $\Phi(s(a))=s(\Phi(a))$ 2. $\Phi(t(a))=t(\Phi(a))$ This gives a category $\bf{Graph}$ of generalized graphs.
Definition 45. Let $b$ be an element in an ideal elementary topos $\mathscr{E}$. We define the slice category above or below $b$ to be the set of all triples $(f,s,t)$ that satisfy: $s:\bar{s}\to b$, $t:\bar{t}\to b$, $f:\bar{s}\to\bar{t}$, and $t\cdot f=s$. Composition and source/target are defined by: $(g,t,r)\cdot(f,s,t):=(g\cdot f,s,r),$ $\overline{(f,s,t)}:=(1_{\bar{s}},s,s),$ $\widehat{(f,s,t)}:=(1_{\bar{t}},t,t).$ These operations define the structure of a one-category on $\mathscr{E}/b$.
Definition 21. Let $\mathscr{C}$ be a generalized category, $I$ a generalized category (the index of a cone needs only be a set, but in practice it is always a (generalized) category). A cone in $\mathscr{C}$ with index $I$ is a map $\sigma:I\to\mathscr{C}$ such that $\text{for all $i,j\in I$, }\overline{\sigma(i)}=\overline{\sigma(j)}.$ Dually, cocone in $\mathscr{C}$ with index $I$ is a map $\sigma:I\to\mathscr{C}$ such that for all $i,j\in I$, $\widehat{\sigma(i)}=\widehat{\sigma(j)}.$ A cone or cocone is finitely generated if the index set $I$ is finitely generated (Definition 4). This common source is the vertex of the cone, and the vertex of a cocone is the common target. Given a cone or cocone $\pi$, we may refer to $\pi(i)$ for some $i\in I$ as a member of the cone.
Definition 58. Let $\mathscr{C}$ be a generalized category and let $J$ be a topology on $\mathscr{C}$. Let $P$ be a generalized presheaf on $\mathscr{C}$, and let $\mathscr{S}$ be a covering sieve in $\mathscr{C}$. A matching family in $P$ with respect to $\mathscr{S}$ is a mapping $x:\mathscr{S}\to\operatorname{Sect}(P),$ where $\operatorname{Sect}(P)$ is the set of all sections of $P$, that satisfies: 1. $x$ assigns a section of $P$ to each element $\rho$ in $\mathscr{S}$, 2. (compatibility) For all $\sigma$ in $\mathscr{C}$, $x(\rho)\cdot\sigma\downarrow$ implies $x(\rho)\cdot\sigma=x(\rho\cdot\sigma).$ If $x=\{x_{\rho}\}$ is a matching family, an amalgamation of $x$ is an element $s\in\overline{\mathscr{S}}$ such that such that $\text{For every $\rho\in\mathscr{S}$, }x(\rho)=s\cdot\rho.$ that is, $x$ is completely determined by $s$. An amalgamation need not exist, or be uniquely defined if it exists. A generalized sheaf on $\mathscr{C}$ or on $(\mathscr{C},J)$ is a generalized presheaf $P$ such that for every element $U$ of $\mathscr{C}$, and for every cover $\mathscr{S}$ of $U$, every matching family for $\mathscr{S}$ has a unique amalgamation. The generalized category of generalized sheaves on a site $\mathscr{C}$ is the subcategory $\operatorname{{\bf Sh}}(\mathscr{C},J)$ of the generalized category of generalized presheaves consisting of generalized presheaves $P$ that satisfy: $P\text{ is a sheaf with respect to $J$},\text{ and }\operatorname{{\bf s}}(P),% \operatorname{{\bf t}}(P)\text{ is in $\operatorname{{\bf Sh}}(\mathscr{C},J)$.}$ along with composition induced from the category of generalized presheaves.
Definition 39. Let $\Lambda$ be a generalized typed lambda calculus. Define a mapping $\Lambda$ to $\mathbf{L}\mathbf{C}\Lambda$ by defining, in the pre-generalized typed lambda calculus $\Lambda_{0}$ obtained by ignoring equalities in $\mathscr{S}_{\Lambda}$, $\displaystyle\eta_{\Lambda}(A)$ $\displaystyle:=A_{\left({}^{\bullet}\,A\right)}$ $\displaystyle A\in\mathscr{T}_{\Lambda},$ $\displaystyle\eta_{\Lambda}(k)$ $\displaystyle:=\left({}^{x}\,k\right),$ $\displaystyle k\in\mathscr{S}_{\Lambda},\operatorname{FV}(k)=\text{{\O}},% \operatorname{ty}(x)=\top_{\mathbf{L}\mathbf{C}\Lambda},$ $\displaystyle\eta_{\Lambda}(\alpha^{\cdot})$ $\displaystyle:=(\eta_{\Lambda}(\alpha))^{\cdot},$ $\displaystyle\alpha\in\Lambda,$ $\displaystyle\eta_{\Lambda}(\pi(\phi))$ $\displaystyle:=\pi(\eta_{\Lambda}\phi),$ $\displaystyle\eta_{\Lambda}(\pi^{\prime}(\phi))$ $\displaystyle:=\pi^{\prime}(\eta_{\Lambda}\phi),$ $\displaystyle\eta_{\Lambda}(\langle\phi,\psi\rangle)$ $\displaystyle:=\langle\eta_{\Lambda}(\phi),\eta_{\Lambda}(\psi)\rangle$ $\displaystyle\eta_{\Lambda}(\phi\wr\psi)$ $\displaystyle:=\eta_{\Lambda}(\phi)\wr\eta_{\Lambda}(\psi)$ $\displaystyle\eta_{\Lambda}(\lambda(x,\phi))$ $\displaystyle:=\lambda(\eta_{\Lambda}(x),\eta_{\Lambda}(\phi))$ $\displaystyle x\in\mathscr{X}_{\Lambda}$ The map $\eta_{\Lambda}$ is well-defined upon passage to $\Lambda$, since analogous equalities between polynomials hold in both $\Lambda$ and $\mathbf{L}\mathbf{C}\Lambda$.
Definition 2. A generalized category is a structure $(\mathscr{C},\sqsubseteq,\operatorname{{\bf s}},\operatorname{{\bf t}},\cdot)$ where $\mathscr{C}$ is a set, $\sqsubseteq$ is a relation on $\mathscr{C}$, $\operatorname{{\bf s}}$ and $\operatorname{{\bf t}}$ are operators (mappings) $\mathscr{C}\to\mathscr{C}$, and $(\cdot)$ is a partially defined binary operation $\mathscr{C}\times\mathscr{C}\to\mathscr{C}$, denoted $a\cdot b$ or $ab$. These are required to satisfy 1. $(\mathscr{C},\sqsubseteq)$ is a partially ordered set, 2. If $(ab)c$ $\downarrow$ or $a(bc)$ $\downarrow$ then $(ab)c=a(bc)$. 3. If $ab$ $\downarrow$ then $\operatorname{{\bf s}}(ab)=\operatorname{{\bf s}}(b)$ and $\operatorname{{\bf t}}(ab)=\operatorname{{\bf t}}(a)$. 4. $ab$ $\downarrow$ if and only if $\operatorname{{\bf s}}(a)\sqsubseteq\operatorname{{\bf t}}(b)$. 5. (Object-Identity) Let $a\in\mathscr{C}$ and $\operatorname{{\bf s}}(a)=\operatorname{{\bf t}}(a)=a$. Then (a) if $ba$ $\downarrow$ then $ba=b$. (b) If $ab$ $\downarrow$ then $ab=b$. 6. (Order Congruences) (a) If $a\sqsubseteq b$ then $\operatorname{{\bf s}}(a)\sqsubseteq\operatorname{{\bf s}}(b)$ and $\operatorname{{\bf t}}(a)\sqsubseteq\operatorname{{\bf t}}(b)$. (b) $a\sqsubseteq b$ and $c\sqsubseteq d$ and $ac,bd$ $\downarrow$ implies $ac\sqsubseteq bd.$ (c) $a\sqsubseteq b$ implies $1_{a}\sqsubseteq 1_{b}$. A generalized category is said to be equipped with identities if for every $a\in\mathscr{C}$, if there exists $b\in\mathscr{C}$ such that $\operatorname{{\bf s}}(b)=a$ or $\operatorname{{\bf t}}(b)=a$, then there exists $c\in\mathscr{C}$ such that $cb$ $\downarrow$ implies $cb=b$, and $bc$ $\downarrow$ implies $bc=b$.The element $c$ is unique, and is denoted $1_{a}$ or $\text{id}_{a}$, and called the identity on $a$. An element $f\in\mathscr{C}$ is an element $f$ of the underlying set $\mathscr{C}$. An object $a$ in $\mathscr{C}$ is an element $a$ of $\mathscr{C}$ such that $\operatorname{{\bf s}}(a)=\operatorname{{\bf t}}(a)=a$. A subject $U$ in $\mathscr{C}$ is an element $U$ of $\mathscr{C}$ such that there exists $f\in\mathscr{C}$ such that $\operatorname{{\bf s}}(f)=U$, or there exists $f\in\mathscr{C}$ such that $\operatorname{{\bf t}}(f)=U$.
Definition 53. Let $\mathscr{C}$ be a generalized category. The ideal maximal bipartite generalized category $\mathscr{E}$ over $\mathscr{C}$ is called the generalized category of generalized presheaves over $\mathscr{C}$. An element $P$ of the upper region of $\mathscr{E}$ is called a generalized presheaf over $\mathscr{C}$.
Definition 30. An positive intuitionistic generalized deductive system is a generalized deductive system $(\mathscr{A},s,t,\cdot,\vdash,\mathscr{V})$ equipped with the additional structure $(\top,\wedge,\langle,\rangle,()^{*})$ consisting of: 1. A distinguished element $\top\in\mathscr{A}$, 2. A mapping $\wedge:\mathscr{A}\times\mathscr{A}\to\mathscr{A}$, 3. A partially defined mapping $\langle,\rangle:\mathscr{A}\times\mathscr{A}\to\mathscr{A}$, 4. A partially defined mapping $()^{*}:\mathscr{A}\to\mathscr{A}$ subject to the following axioms, 1. $\langle a,b\rangle$ is defined if and only if the source of $a$ and $b$ are identical. 2. $a^{*}$ is defined if and only if the source of $a$ is the wedge of two subjects in $\mathscr{A}$. the following source and target conditions: 1. $\hat{\top}=\bar{\top}=\top$, 2. $s(a\wedge b)=s(a)\wedge s(b)$ and $t(a\wedge b)=t(a)\wedge t(b)$, 3. $s(\langle a,b\rangle)=s(a)$ and $t(\langle a,b\rangle)=t(a)\wedge t(b)$ 4. $s(a^{*})=proj_{1}(s(a))$ and $t(a^{*})=proj_{2}(s(a))\vdash t(a)$, where $proj_{1}$ and $proj_{2}$ are the projections on wedge ($\wedge$) products. and the following rules, or validities: For all $a,b\in\mathscr{V}$, 1. $\top\in\mathscr{V}$, 2. $a\wedge b$ is valid if $a$ and $b$ are valid, 3. $\langle a,b\rangle$ is valid if $a$ and $b$ are valid, 4. $a^{*}$ is valid if $a$ is valid, 5. for every pair of subjects $a,b\in\mathscr{A}$, the following types are valid: (a) $\top\vdash a$ (b) $a\wedge b\vdash a$ (c) $a\wedge b\vdash b$ (d) $(a\vdash b)\wedge a\vdash b$ A morphism $f:\mathscr{A}\to\mathscr{B}$ of positive intuitionistic generalized deductive systems is a morphism of generalized deductive systems satisfying 1. $F(\top)=\top,$ 2. $F(a\wedge b)=F(a)\wedge F(b),$ 3. $F(\langle f,g\rangle)=\langle F(f),F(g)\rangle,$ 4. $F(f^{*})=F(f)^{*}.$ This gives a category ${\bf p.i.DedSys}$ of positive intuitionistic generalized deductive systems.
Definition 47. Let $(\mathscr{E},j)$ be an elementary ideal topos $\mathscr{E}$ equipped with a Lawvere-Tierney topology $j$. A sheaf for $j$ on $\mathscr{E}$ is an element $P$ of $\mathscr{E}$ such that for every monic $m$ in $\mathscr{E}$, and for every $f:\bar{m}\to P$ in $\mathscr{E}$, if $m$ is dense, there exists a unique $g\in\mathscr{E}$ such that $g\cdot m=f.$
Definition 23. Let $F:C\to C^{\prime}$ be a functor. Then $F$ preserves limits or is left exact if for every functor $\alpha:I\to C$, $F(\lim(\alpha))\subset\lim(F\mathbin{\circ}\alpha).$ Dually, $F$ preserves colimits or is right exact if for every functor $\alpha:I\to C$, $F(\operatorname{colim}(\alpha))\subset\operatorname{colim}(F\mathbin{\circ}% \alpha).$ $F$ is said to create limits if for every element $\pi\in\lim(F\mathbin{\circ}\alpha)$, there exists a unique $\pi^{\prime}\in\lim(\alpha)$ such that $F(\pi^{\prime})=\pi$. Dually, $F$ is said to create colimits if for every element $\pi\in\operatorname{colim}(F\mathbin{\circ}\alpha)$, there exists a unique $\pi^{\prime}\in\operatorname{colim}(\alpha)$ such that $F(\pi^{\prime})=\pi$.
Definition 37. Let $\Lambda$ be a typed lambda calculus. Let $\mathscr{B}_{\Lambda}$ be the set of bulletins in $\Lambda$, that is, the set of terms in $\Lambda$ that have only one free variable. Also for $A\in\mathscr{T}_{\Lambda}$, let $\left({}^{\bullet}\,A\right):=\left({}^{x}\,\ulcorner A\urcorner\wr x\right),% \quad x:\bar{A},$ that is, a symbol $\left({}^{x}\,s\right)$ where $x$ is a variable of type $\bar{A}$, and $s$ is the term $\ulcorner A\urcorner\wr x$. By Axiom (6c) of Definition 36 we may identify these symbols with types in $\Lambda$. We define $\mathbf{C}\Lambda$ to be the set $\mathbf{C}\Lambda:=\{\left({}^{x}\,s\right)\mid s\in\mathscr{B}_{\Lambda},% \text{ $x$ a variable}\},$ of symbols $\left({}^{x}\,s\right)$ for variable $x$ and bulletin $s$, equipped with the structure $\displaystyle\overline{\left({}^{x}\,s\right)}$ $\displaystyle:=\left({}^{\bullet}\,\operatorname{ty}(x)\right),$ $\displaystyle\widehat{\left({}^{x}\,s\right)}$ $\displaystyle:=\left({}^{\bullet}\,\operatorname{ty}(s)\right),$ $\displaystyle\left({}^{x}\,s\right)\cdot\left({}^{y}\,t\right)$ $\displaystyle:=\left({}^{y^{\prime}}\,s[x/t]\right),$ $\displaystyle\left({}^{x}\,s\right)\vdash\left({}^{y}\,t\right)$ $\displaystyle:=\left({}^{u}\,v\right),\quad u:\operatorname{ty}(s),v:% \operatorname{ty}(t),$ where $y^{\prime}=\begin{cases}y&\text{ if $\operatorname{FV}(t)$ is empty},\\ inc_{n}(y)&\text{ if $\operatorname{FV}(t)=\{u\}$ and $\operatorname{FV}(s[x/t% ])=\{inc_{n}(u)\}$,}\end{cases}$ where $inc_{n}$ is the modification of the variable described after Definition 35. Let $\mathscr{K}_{\mathbf{C}\Lambda}$ be the set of symbols $\left({}^{x}\,k\right)$ where $k$ is a constant in $\Lambda$, that is, $\operatorname{FV}(k)=\text{{\O}}$. Let equality of symbols in $\mathbf{C}\Lambda$ be defined by 1. $\left({}^{x}\,s\right)=\left({}^{y}\,t\right)$ if $\operatorname{ty}(x)=\operatorname{ty}(y),\operatorname{ty}(s)=\operatorname{% ty}(t),$ and there is $z:\operatorname{ty}(x)$ such that $s[x/z]=t$, 2. $\left({}^{x}\,s\right)=\left({}^{x}\,u\right),\quad u:\operatorname{ty}{s},\,\,$ if $\operatorname{FV}(s)=\{y\}$ and $y\neq x$, 3. if $\operatorname{ty}(s)=\top$, then $\left({}^{x}\,s\right)=\left({}^{x}\,*\right)$, 4. for all bulletins $s$ and all variables $x,y$ of the same type, $\left({}^{x}\,s\right)=\left({}^{y}\,s[x/y]\right)$. This gives an ideal category $\mathbf{C}\Lambda$, where the identity of $\left({}^{x}\,s\right)$ is $1_{\left({}^{x}\,s\right)}=\left({}^{y}\,y\right),\quad y:s^{\natural},$ terminal arrows are of the form $\left({}^{y}\,*\right),$ and types (in the sense of section 13) are of the form $\left({}^{x}\,y\right),\quad x\neq y.$ Validities defining $\mathbf{C}\Lambda$ are the evident ones based on Definition 31.
Definition 9. If $\mathscr{C}$ is a generalized category, an element $a\in\mathscr{C}$ is invertible if there exists $b\in\mathscr{C}$ such that $ab=1_{\hat{a}}$ and $ba=1_{\bar{a}}$.
Definition 43. An ideal elementary topos is an ideal cartesian closed category $\mathscr{E}$ with 1. all finite limits and colimits,4As in the one-category case, it suffices to have a terminal/equalizers/products, or a terminal/pullbacks (dually for colimits) [30]. 2. a subobject classifier.
