Definition 4.10. By Corollary 3.23, the equivalence class of the splitting exact sequences forms one element in $\mathbb{E}(C,A)$ for each $A,C\in h\mathscr{C}$. We denote this particular element by ${}_{A}0_{C}$. Especially we have ${}_{A}0_{C}={}_{A}\underline{\mathbf{N}}_{C}={}_{A}\underline{\mathbf{N}^{% \prime}}_{C}$.
Definition 3.15. Let $A,C\in\mathscr{C}_{0}$ be any pair of objects, and let $\xy(-7,7)*+{A}="0";(-7,-7)*+{O}="4";(7,-7)*+{C}="6";{\ar_{i}"0";"4"};{\ar_{j}"% 4";"6"};{\ar^{z}"0";"6"};(-3,-7)*+{}="10";(-7,-3)*+{}="11";{\ar@/_{0}.2pc/@{-}% _{{}_{\eta}}"10";"11"};\endxy$ be any $2$-simplex in $\mathscr{C}$, in which $O\in\mathscr{C}_{0}$ is a zero object. Let $A\overset{p_{A}}{\longleftarrow}A\times C\overset{p_{C}}{\longrightarrow}C$ and $A\overset{i_{A}}{\longrightarrow}A\amalg C\overset{i_{C}}{\longleftarrow}C$ be a product and a coproduct of $A$ and $C$, respectively. (1) By the definition of product, we obtain a pair of $2$-simplices as below. $\xy(0,7)*+{A}="0";(-18,-7)*+{A}="2";(0,-7)*+{A\times C}="4";(18,-7)*+{C}="6";{% \ar_{1_{A}}"0";"2"};{\ar^{u_{A}}"0";"4"};{\ar^{z}"0";"6"};{\ar^{p_{A}}"4";"2"}% ;{\ar_{p_{C}}"4";"6"};(-13,-2)*+{}="10";(-11,-7.5)*+{}="11";{\ar@/^{0}.2pc/@{-% }^{{}_{\mu_{A,C}}}"10";"11"};(13,-2)*+{}="20";(11,-7.5)*+{}="21";{\ar@/_{0}.2% pc/@{-}_{{}_{\pi_{A,C}}}"20";"21"};\endxy$ (2) Dually, we obtain a pair of $2$-simplices as below. $\xy(0,-7)*+{C}="0";(-18,7)*+{A}="2";(0,7)*+{A\amalg C}="4";(18,7)*+{C}="6";{% \ar_{z}"2";"0"};{\ar^{j_{C}}"4";"0"};{\ar^{1_{C}}"6";"0"};{\ar^{(}0.4){i_{A}}"% 2";"4"};{\ar_{(}0.4){i_{C}}"6";"4"};(-13,2)*+{}="10";(-11,7.5)*+{}="11";{\ar@/% _{0}.2pc/@{-}_{{}_{\iota_{A,C}}}"10";"11"};(13,2)*+{}="20";(11,7.5)*+{}="21";{% \ar@/^{0}.2pc/@{-}^{{}_{\nu_{A,C}}}"20";"21"};\endxy$ We will use these symbols in the rest, often abbreviating $\pi_{A,C}$ to $\pi$ and so on.
Definition 4.20. Let $A,C\in\mathscr{C}_{0}$ be any pair of objects. For each $\delta\in\mathbb{E}(C,A)$, take any $\mathbf{S}=\ \xy(-7,7)*+{A}="0";(7,7)*+{B}="2";(-7,-7)*+{O}="4";(7,-7)*+{C}="6% ";{\ar^{x}"0";"2"};{\ar_{i}"0";"4"};{\ar^{y}"2";"6"};{\ar_{j}"4";"6"};\endxy$ such that $\delta=\underline{\mathbf{S}}$, and put $\mathfrak{s}(\delta)=[A\overset{\overline{x}}{\longrightarrow}B\overset{% \overline{y}}{\longrightarrow}C]$, where the equivalence class of the sequences is the one in Definition 4.1. Well-definedness follows from Proposition 3.26.
Definition 3.27. Let $A,C\in\mathscr{C}_{0}$ be any pair of objects. Let ${}_{A}\mathbf{S}_{C}=\ \xy(-7,7)*+{A}="0";(7,7)*+{B}="2";(-7,-7)*+{O}="4";(7,-% 7)*+{C}="6";{\ar^{x}"0";"2"};{\ar_{i}"0";"4"};{\ar^{y}"2";"6"};{\ar_{j}"4";"6"% };\endxy\ ,\ \ {}_{A}\mathbf{S}^{\prime}_{C}=\ \xy(-7,7)*+{A}="0";(7,7)*+{B^{% \prime}}="2";(-7,-7)*+{O^{\prime}}="4";(7,-7)*+{C}="6";{\ar^{x^{\prime}}"0";"2% "};{\ar_{i^{\prime}}"0";"4"};{\ar^{y^{\prime}}"2";"6"};{\ar_{j^{\prime}}"4";"6% "};\endxy$ be two exact sequences starting from $A$ and ending in $C$. We say $\mathbf{S}$ is equivalent to $\mathbf{S}^{\prime}$ if there is a morphism of exact sequences ${}_{1_{A}}\mathbf{C}_{1_{C}}\colon\mathbf{S}\to\mathbf{S}^{\prime}$. In this case we write $\mathbf{S}\sim\mathbf{S}^{\prime}$. By Corollary 2.6, this is equivalent to the existence of a morphism ${}_{a}\mathbf{C}^{\prime}_{c}\colon\mathbf{S}\to\mathbf{S}^{\prime}$ satisfying $\overline{a}=\mathrm{id}_{A}$ and $\overline{c}=\mathrm{id}_{C}$.
Definition 3.2. ([B1, Definition 3.1]) $\ \ $ (1) An exact sequence starting from $A$ and ending in $C$ is an ambigressive pull-back (hence an ambigressive push-out) $\mathbf{S}=\ \xy(-7,7)*+{A}="0";(7,7)*+{B}="2";(-7,-7)*+{O}="4";(7,-7)*+{C}="6% ";{\ar^{x}"0";"2"};{\ar_{i}"0";"4"};{\ar|*+{{}_{z}}"0";"6"};{\ar^{y}"2";"6"};{% \ar_{j}"4";"6"};(3,7)*+{}="00";(7,3)*+{}="01";{\ar@/_{0}.2pc/@{-}_{{}^{\xi}}"0% 0";"01"};(-3,-7)*+{}="10";(-7,-3)*+{}="11";{\ar@/_{0}.2pc/@{-}_{{}_{\eta}}"10"% ;"11"};\endxy$ in which $O$ is a zero object in $\mathscr{C}$. When we emphasize the end-objects $A$ and $C$, we write ${}_{A}\mathbf{S}_{C}$ in this article.
Definition 4.4. Let $A,C\in\mathscr{C}_{0}$. Define $\mathbb{E}(C,A)$ to be the set of equivalence classes of exact sequences $\mathbf{S}$ starting from $A$ and ending in $C$, modulo the equivalence relation $\sim$ defined in Definition 3.27. For each exact sequence ${}_{A}\mathbf{S}_{C}$, let $\delta=\underline{\mathbf{S}}$ denote its equivalence class with respect to $\sim$. When we emphasize the end-objects $A$ and $C$, we write ${}_{A}\delta_{C}={}_{A}\underline{\mathbf{S}}_{C}$.
Definition 5.12 (Environment functor). For every set $G$ and non-negative integer $N$, we denote by $\mathsf{E}_{N}(G)$ the functor resulting from the composition of the functor $\mathsf{Tr}:\mathbf{PS}(N)\to\mathbf{Set}^{\mathrm{op}}$ with the hom-set functor $\mathbf{Set}(\_,G):\mathbf{Set}^{\mathrm{op}}\to\mathbf{Set}$. We will refer to $\mathsf{E}_{N}(G)$ as an environment functor.
Definition 3.6 (Optimal solutions). Let $(S,<)$ be a finite strict linear order, $(a,b)$ be an embedding problem in $\mathbf{UP}(S)$ and $x$ be a solution in $\mathbb{V}(a,b)$ such that $\mathsf{fib}(a)=\{a_{i}\}_{i\in[n]}$, $\mathsf{fib}(b)=\{b_{k}\}_{k\in[m]}$, and $\mathsf{fib}(x)=\{x_{j}\}_{j\in[p]}$. The solution $x$ is said to be optimal if for every distinct elements $j_{1},j_{2}\in[p]$, there exist $i\in[n]$ and two distinct elements $k_{1},k_{2}\in[m]$ such that $a_{i}\cap x_{j_{1}}\cap b_{k_{1}}\neq\emptyset$ and $a_{i}\cap x_{j_{2}}\cap b_{k_{2}}\neq\emptyset$.
Definition 2.9 (Induced order). Let $(S,<)$ be a finite strict linear order2A transitive relation $<$ on a finite set $S$ such that for every pair $(x,y)\in S\times S$, either $x<y$, or $y<x$, or $x=y$ holds. and denote by $\mathsf{min}$ the minimum operation for this linear order. For every labeled partition $p:S\to K$ in $\mathbf{LP}(S)$ and every $x,y\in K$, we write $x<_{p}y$ if and only if the relation $\mathsf{min}(p^{-1}(x))<\mathsf{min}(p^{-1}(y))$ holds.
Definition 4.1 (Fiber matrix). Let $g$ and $g^{\prime}$ be two non-negative integers and let $f:[g]\to[g^{\prime}]$ be a function. We denote by $\mathsf{M}(f)$ the $g\times g^{\prime}$-matrix whose coefficients $m_{i,j}(f)$ defined as follows: $m_{i,j}(f)=\left\{\begin{array}[]{ll}1&\textrm{if }i=f(j)\\ 0&\textrm{if }i\neq f(j)\end{array}\right.$
Definition 5.3 (Global plain segments). For every non-negative integer $N$, we will denote by $\mathbf{1}_{N}$ the segment defined by the constant function $[N]\to\{0,1\}$ mapping every $i\in[N]$ to $1$.
Definition 4.9 (ANOVA setting). Let $(S,<)$ be a finite strict linear order and $y:S\to\mathbb{R}$ be a function. For every partition $p:S\to[g]$ in $\mathbf{UP}(S)$, we will denote by $\mathsf{Anova}_{y}(p)$ the object $(g,v,c)$ of $\mathbf{Data}$ defined by the following equations. $v=\Big{(}\mu_{y}(p^{-1}(1))),\mu_{y}(p^{-1}(2)),\dots,\mu_{y}(p^{-1}(g))\Big{)% }\quad\quad c=\Big{(}|p^{-1}(1))|,|p^{-1}(2))|,\dots,|p^{-1}(g))|\Big{)}$
Definition 2.18 (Unlabeled partitions). For every finite strict linear order $(S,<)$, we will denote by $\mathbf{UP}(S)$ the full subcategory of $\mathbf{LP}(S)$ whose objects are of the form $R(p)$ (Definition 2.14) for some labeled partition $p$ in $\mathbf{LP}(S)$. An object $p:S\to[n]$ in $\mathbf{UP}(S)$ will be called an unlabeled partition of $S$.
Definition 4.5 (Data category). We denote by $\mathbf{Data}$ the category whose objects are pairs $(g,v,c)$ where $g$ is a non-negative integer, $v$ is a vector in $\mathbb{R}^{g}$ and $c$ is a vector in $\mathbb{N}^{g}_{*}$ and whose arrows $(g,v,c)\to(g^{\prime},v^{\prime},c^{\prime})$ are surjections $f:[g]\to[g^{\prime}]$ satisfying the following equations: $\mathsf{M}(f)c=c^{\prime}\quad\quad\mathsf{M}(f)(v\odot c)=(v^{\prime}\odot c^% {\prime})$ The composition operation of $\mathbf{Data}$ is induced by the composition of surjections.
Definition 5.7 (Exactness). For every non-negative integer $N$, any pair $(\tau_{1},\tau_{2})$ of objects in $\mathbf{PS}(N)$ is said to be exact if the intersection $\tau_{1}^{-1}(1)\cap\tau_{2}^{-1}(1)$ is empty. By extension, if $(\tau_{1},\tau_{2})$ is exact, then we say that the sum $\tau_{1}+\tau_{2}$ is exact (See Example 5.8).
Definition 4.15 (Between-group change). For every arrow $f:(g_{1},v_{1},c_{1})\to(g_{2},v_{2},c_{2})$ of $\mathbf{Data}$, we define the between-group change of $f$ as the following quantity: $\varepsilon(f)=(g_{1}-1)\eta(g_{1},v_{1},c_{1})-(g_{2}-1)\eta(g_{2},v_{2},c_{2})$
Definition 2.33 (Product decompositions). Let $(S,<)$ be a finite strict linear order and let $p:S\to[n]$ be an unlabeled partition in $\mathbf{UP}(S)$. A product decomposition for $p$ is a non-empty finite collection $x=\{x_{i}\}_{i\in[r]}$ of subsets $x_{i}$ of $S$ for which the following equation holds: $p=\delta(x_{1})\times\delta(x_{2})\times\dots\times\delta(x_{n})$
Definition 2.1 (Labeled partitions). For every finite set $S$, we will denote by $\mathbf{LP}(S)$ the category whose objects are surjections of the form $p:S\to K$ for some set $K$ and wose arrows $p_{1}\to p_{2}$ between two objects $p_{1}:S\to K_{1}$ and $p_{2}:S\to K_{2}$ are functions $f:K_{1}\to K_{2}$ for which the following diagram commutes. $\xymatrix{S\ar@{=}[r]&S\\ K_{1}\ar[r]^{f}\ar@{<-}[u]^{p_{1}}&K_{2}\ar@{<-}[u]_{p_{2}}}$ The composition of two arrows $f:p_{1}\to p_{2}$ and $g:p_{2}\to p_{3}$ corresponds to the composition $f\circ g:p_{1}\to p_{3}$ of the underlying functions $f$ and $g$. An object $p:S\to K$ in $\mathbf{LP}(S)$ will be called a labeled partition of $S$ and its associated set $K$ will be called the set of labels.
Definition 5.22 (Combinatorial association). Let $G$ be a set, $N$ be a non-negative integer, $(S,<)$ be a finite strict linear oder and $\gamma$ be a genotype morphism in $\mathsf{Gen}_{N}(S,G)$. For every unlabeled partition $b$ in $\mathbf{UP}(S)$, we define a combinatorial association for $(b,\gamma)$ as a pair $(e,\tau)$ where $e\in\mathbb{V}(P_{\gamma}(\mathbf{1}_{N}),b)$ and $\tau\in\mathbf{PS}(N)$ such that 1) (external factors) $e$ is a minimal solution of $\mathbb{V}(P_{\gamma}(\mathbf{1}_{N}),b)$; 2) (localization) $e$ is a solution of $\mathbb{V}(P_{\gamma}(\tau),b)$; 3) (minimality) if there exists an arrow $f:\tau\to\tau^{\prime}$ in $\mathbf{UP}(S)$ such that $e\in\mathbb{V}(P_{\gamma}(\tau^{\prime}),b)$, then $f$ is an identity.
Definition 3.10 (Reduction). Let $(S,<)$ be a finite strict linear order, $(a,b)$ be a pair of partitions in $\mathbf{UP}(S)$ such that $\mathsf{fib}(a)=\{a_{i}\}_{i\in[n]}$ and $\mathsf{fib}(b)=\{b_{k}\}_{k\in[m]}$. For every partition $x$ in $\mathbf{UP}(S)$ such that $\mathsf{fib}(x)=\{x_{j}\}_{j\in[p]}$, we define the set $L_{a,b}(x):=\{(j_{1},j_{2})\in[p]\times[p]~{}|~{}j_{1}\neq j_{2}\textrm{ and }% a_{i}\cap x_{j_{1}}\neq\emptyset\Rightarrow a_{i}\cap x_{j_{2}}=\emptyset\}.$ We will call a reduction of $x$ any infinite sequence $(u_{k})_{k\geq 0}$ of partitions in $\mathbf{UP}(S)$ satisfying the following construction: $\left\{\begin{array}[]{l}u_{0}=x\\ u_{k+1}=\left\{\begin{array}[]{ll}u_{k}[j_{1},j_{2}]&\textrm{for some }(j_{1},% j_{2})\in L_{a,b}(u_{k})\textrm{ if }L_{a,b}(u_{k})\neq\emptyset\\ u_{k}&\textrm{if }L_{a,b}(u_{k})=\emptyset\\ \end{array}\right.\end{array}\right.$
Definition 4.27 ($\mathsf{F}$-ratio). Let $(S,<)$ be a finite strict linear order and $y:S\to\mathbb{R}$ be a function. For every partition $p:S\to[g]$ in $\mathbf{UP}(S)$ for which $\rho_{y}(p)$ is non-zero, we define the $\mathsf{F}$-ratio of $p$ as the ratio: $\mathsf{F}_{y}(p)=\frac{\eta_{y}(p)}{\rho_{y}(p)}$
Definition 4.6 (Cardinal and mean). For every object $(g,v,c)$ in $\mathbf{Data}$, we define the cardinal $N(g,v,c)$ and the mean $\mu(g,c,v)$ of the object $(g,c,v)$ by the following quantities: $N(g,v,c)=\sum_{i=1}^{g}c_{k}\quad\quad\quad\mu(g,v,c)=\frac{1}{N(g,v,c)}\sum_{% i=1}^{g}c_{i}v_{i}$
Definition 5.16 (Genotypes). Let $G$ be a set, $N$ be a non-negative integer and $(S,<)$ be a finite strict linear oder. We define a genotype morphism for $S$ over $G$ as a function $\gamma:S\to\mathbf{Env}_{N}(G^{\times 2})(\mathbf{1}_{N})$. The set of such functions will be denoted as $\mathsf{Gen}_{N}(S,G)$.
Definition 4.25 (Within-group mean square sums). Let $(S,<)$ be a finite strict linear order and $y:S\to\mathbb{R}$ be a function. For every partition $p:S\to[g]$ in $\mathbf{UP}(S)$ whose underlying surjection is not a bijection, we will call the within-group mean square sum the real number $\rho_{y}(p)$ determined by the following equation: $|S|\sigma^{2}_{y}(S)=(|S|-g)\rho_{y}(p)+(g-1)\eta_{y}(p)$ If the surjection $p:S\to[g]$ is a bijection, then we let $\rho_{y}(p)$ be zero.
Definition 3.8 (Contractions). Let $(S,<)$ be a finite strict linear order and $x$ be a partition in $\mathbf{UP}(S)$ such that $\mathsf{fib}(x)=\{x_{j}\}_{j\in[p]}$. For every pair $(j_{1},j_{2})\in[p]\times[p]$, we define the contraction of $x$ at $(j_{1},j_{2})$ as the following partition $x[j_{1},j_{2}]:=\prod_{i=[p]\backslash\{j_{1},j_{2}\}}\delta(x_{i})\times% \delta(x_{j_{1}}\cup x_{j_{2}})$
Definition 4.13 (Between-group mean square sums). For every object $(g,v,c)$ of $\mathbf{Data}$, we define the between-group mean square sum of $(g,v,c)$ as the following quantity: $\eta(g,v,c)=\left\{\begin{array}[]{ll}\displaystyle 0&\textrm{if }g=1\\ \displaystyle\frac{1}{g-1}\sum_{i=1}^{g}c_{i}(v_{i}-\mu(g,c,v))^{2}&\textrm{if% }g>1\\ \end{array}\right.$
Definition 2.4 (Image). For every function $f:X\to Y$, we will call the image of $f$ the subset $\mathsf{Im}(f)$ of $Y$ that contains the element $f(x)$ for every $x\in X$.
Definition 4.2 (Matrix category). We will denote by $\mathbf{Mat}$ the category whose objects are non-negative integers and whose arrows $g\to g^{\prime}$ are given by $g\times g^{\prime}$-matrices of real numbers. The composition is given by the usual matrix multiplication.
Definition 5.5 (Sums). For every non-negative integer $N$ and every pair $(\tau_{1},\tau_{2})$ of objects in $\mathbf{PS}(N)$, we denote by $\tau_{1}+\tau_{2}$ the segment $[N]\to\{0,1\}$ mapping every integer $i\in[N]$ to the maximum value of the set $\{\tau_{1}(i),\tau_{2}(i)\}$ (See Example 5.8).
Definition 4.8 (Cardinal, mean and variance). Let $S$ be a finte set and $y:S\to\mathbb{R}$ be a function. For every subset $T\subseteq S$, we denote by $|T|$ the cardinal of $T$ and we define the mean $\mu_{y}(T)$ and the variance $\sigma^{2}_{y}(T)$ of the object $T$ by the following quantities: $\mu_{y}(T)=\frac{1}{|T|}\sum_{s\in T}y(s)\quad\quad\quad\sigma^{2}_{y}(T)=% \frac{1}{|T|}\sum_{s\in T}(y(s)-\mu_{y}(T))^{2}$
Definition 5.9 (Truncation). For every non-negative integer $N$ and every segment $\tau\in\mathbf{PS}(N)$, we denote by $\mathsf{Tr}(\tau)$ the fiber $\tau^{-1}(1)$, which is a subset of $[N]$.
Definition 3.1 (Embedding problems). Let $(S,<)$ be a finite strict linear order. An embedding problems consists of a pair $(a,b)$ of unlabeled partitions in $\mathbf{UP}(S)$. A solution for the embedding problem $(a,b)$ is an unlabeled partition $x$ in $\mathbf{UP}(S)$ for which there exists a morphism $a\times x\to b$ in $\mathbf{UP}(S)$.
Definition 4.18 (Codegeneracy morphisms). A morphism $f:(g_{1},v_{1},c_{1})\to(g_{2},v_{2},c_{2})$ in $\mathbf{Data}$ is called a codegeneracy morphism if the identity $g_{1}=g_{2}+1$ holds (also, see Proposition 4.19).
Definition 3.12 (Reduced elements). Let $(S,<)$ be a finite strict linear order, $(a,b)$ be a pair of partitions in $\mathbf{UP}(S)$. For every partition $x$ in $\mathbf{UP}(S)$ and every reduction $u=(u_{k})_{k\geq 0}$ of $x$, we denote by $k(u)$ the smallest non-negative integer for which $L_{a,b}(u_{k(u)})$ is empty. We then denote by $u^{*}$ the term $u_{k(u)}$, which we call the reduced element of $u$.
Definition 5.1 (Plain segments). For every non-negative integer $N$, we denote by $\mathbf{PS}(N)$ the category whose objects are functions $\tau:[N]\to\{0,1\}$, which we will call plain segments, and whose arrows $\tau_{1}\to\tau_{2}$ are given by relations $\tau_{2}(i)\leq\tau_{1}(i)$ for every integer $i\in[N]$. Note that this makes the category $\mathbf{PS}(N)$ a pre-ordered set (also referred to as a ‘pre-order category’).
Definition 2.14 (Pointed structure). Let $(S,<)$ be a finite strict linear order. For every object $p:S\to K$ in $\mathbf{LP}(S)$, we will denote by $R(p):S\to[n_{K}]$ the composite of $p:S\to K$ with the bijection $\phi_{K}:K\to[n_{K}]$. The following commutative square gives an isomorphism $\eta_{p}:p\to R(p)$ in $\mathbf{LP}(S)$. $\xymatrix{S\ar[d]_{p}\ar@{=}[r]&S\ar[d]^{R(p)}\\ K\ar[r]^{\phi_{p}}&[n_{K}]}$
Definition 2.7. Fix a non-empty set $\mathtt{S}$, an $\mathtt{S}$-sorted predicate language $\mathfrak{L}$ and $\mathfrak{L}$-structures $\mathsf{L}$ and $\mathsf{M}$. We say $\mathsf{L}$ is an $\mathfrak{L}$-substructure of $\mathsf{M}$ if $s(\mathsf{L})\subseteq s(\mathsf{M})$ for each $s\in\mathtt{S}$ and, labelling these inclusions $\mathsf{i}_{s}$, the family $\{\mathsf{i}_{s}\mid s\in\mathtt{S}\}$ defines an $\mathfrak{L}$-homomorphism $\mathsf{i}:\mathsf{L}\to\mathsf{M}$. If, additionally, $\mathsf{i}:\mathsf{L}\to\mathsf{M}$ is an $\mathfrak{L}$-pure embedding, we say $\mathsf{L}$ is an $\mathfrak{L}$-pure substructure of $\mathsf{M}$.
Definition 4.1. [5, §2] Given $G\in\mathcal{S}$ and an object $M$ of $\mathcal{T}$ with $\mathfrak{L}^{\mathcal{T}}$-structure $\mathsf{M}$, a pp-definable subgroup of $M$ of sort $G$ is the set $\varphi(M)=\{f\in G(\mathsf{M})\mid\mathsf{M}\models\varphi(f)\}$ of solutions (in $\mathsf{M}$) to some pp-formula $\varphi(v_{G})$ in one free variable of sort $G\in\mathcal{S}$. For any morphism $b:X\to Y$ in $\mathcal{T}^{c}$ and any object $M$ in $\mathcal{T}$ recall the map $\mathcal{T}(b,M):\mathcal{T}(Y,M)\to\mathcal{T}(X,M)$ is defined by precomposition with $b$. In this case we let $Mb=\mathrm{im}(\mathcal{T}(b,M))=\{fb\in\mathcal{T}(X,M)\mid f\in\mathcal{T}(Y% ,M)\}$ If $G,H\in\mathcal{S}$ and $\phi_{X}:G\to X$ and $\phi_{Y}:H\to Y$ are isomorphisms in $\mathcal{T}$ (as in the proof of Lemma 3.4), then $fb\mapsto f\phi^{-1}_{Y}b\phi_{X}$ defines a isomorphism $Mb\to\varphi(M)$ in $\mathbf{Ab}$ where $\varphi(v_{G})$ is the pp-formula $\exists u_{H}:v_{G}=u_{H}a$ where $a=\phi^{-1}_{Y}b\phi_{X}$. We continue, slightly abusing terminology, by reffering to any set of the form $Mb$ (for some $b\in\mathcal{T}(X,Y)$) as a pp-definable subgroup of $M$ of sort $X$.
Definition 6.1. Recall Notation 3. Let $I$ be a set and let $M$ be an object of $\mathcal{T}$. By the universal properties of the product and coproduct of the collection $\mathrm{M}=\{M\mid i\in I\}$, there exists a unique summation morphism $\sigma_{I,\mathrm{M}}:\bigoplus_{i}M\to M$ and a unique canonical morphism $\iota_{I,\mathrm{M}}:\bigoplus_{i}M\to\prod_{i}M$ for which $\sigma_{I,\mathrm{M}}u_{i,\mathrm{M}}=1_{M}$ and $\iota_{I,\mathrm{M}}u_{i,\mathrm{M}}=v_{i,\mathrm{M}}$ for each $i$.
Definition 3.2. In what follows let $\mathcal{S}$ denote a fixed set of objects in $\mathcal{T}^{c}$ given by choosing exactly one representative of each isomorphism class. Such a set $\mathcal{S}$ exists because we are assuming that $\mathcal{T}^{c}$ is skeletally small. [5, §3] The canonical language $\mathfrak{L}^{\mathcal{T}}$ of $\mathcal{T}$ is given by a $\mathcal{S}$-sorted predicate language $\langle\mathrm{pred}_{\mathcal{S}},\,\mathrm{func}_{\mathcal{S}},\,\mathrm{ar}% _{\mathcal{S}},\,\mathrm{sort}_{\mathcal{S}}\rangle$, defined as follows. The set $\mathrm{pred}_{\mathcal{S}}$ consists of a symbol $\mathsf{0}_{G}$ with $\mathrm{sort}_{\mathcal{S}}(\mathsf{0}_{G})=G$ for each $G\in\mathcal{S}$. The set $\mathrm{func}_{\mathcal{S}}$ consists of: a ternary symbol $+_{G}$ with $\mathrm{sort}_{\mathcal{S}}(+_{G})=(G,G,G)$ for each $G\in\mathcal{S}$; and a unary operation $-\circ a$ with $\mathrm{sort}_{\mathcal{S}}(-\circ a)=(H,G)$ for each morphism $a:G\to H$ with $G,H\in\mathcal{S}$. Variables of sort $G\in\mathcal{S}$ will be denoted $v_{G}$.
Definition 2.3. [2, Definition 35] Fix a set $\mathtt{S}\neq\emptyset$ and an $\mathtt{S}$-sorted predicate language $\mathfrak{L}$. An $\mathfrak{L}$-structure is a tuple $\mathsf{M}=\langle\mathtt{S}(\mathsf{M}),(R(\mathsf{M})\mid R\in\mathrm{pred}_% {\mathtt{S}}),(F(\mathsf{M})\mid F\in\mathrm{func}_{\mathtt{S}})\rangle$ such that: 1. the symbol $\mathtt{S}(\mathsf{M})$ denotes a family of sets $\{s(\mathsf{M})\mid s\in\mathtt{S}\}$; 2. if $\mathrm{sort}_{\mathtt{S}}(R)=(s_{1},\dots,s_{n})$ then $R(\mathsf{M})$ is a subset of $s_{1}(\mathsf{M})\times\dots\times s_{n}(\mathsf{M})$; and 3. if $\mathrm{sort}_{\mathtt{S}}(F)=(s_{1},\dots,s_{n},s)$ then $F(\mathsf{M}):s_{1}(\mathsf{M})\times\dots\times s_{n}(\mathsf{M})\to s(% \mathsf{M})$ is a function. Denoting the cardinality of any set $X$ by $|X|$, let $|\mathfrak{L}|=|\mathrm{pred}_{\mathtt{S}}\sqcup\mathrm{func}_{\mathtt{S}}|$ and, for $\mathsf{M}$ as above, let $|\mathsf{M}|$ be the sum of the cardinalities $|s(\mathsf{M})|$ as $s$ runs through $\mathtt{S}$.
Definition 2.5. [2, Definition 3] Fix a set $\mathtt{S}\neq\emptyset$, an $\mathtt{S}$-sorted predicate language $\mathfrak{L}$ and $\mathfrak{L}$-structures $\mathsf{L}$ and $\mathsf{M}$. By an $\mathfrak{L}$-homomorphism $\mathsf{h}:\mathsf{L}\to\mathsf{M}$ we mean a family $\{\mathsf{h}_{s}\mid s\in\mathtt{S}\}$ of functions $\mathsf{h}_{s}:s(\mathsf{L})\to s(\mathsf{M})$ such that: 1. if $\mathrm{sort}_{\mathtt{S}}(R)=(s_{1},\dots,s_{n})$ then $R(\mathsf{M})=\{(\mathsf{h}_{s_{1}}(a_{1}),\dots,\mathsf{h}_{s_{n}}(a_{n}))% \mid(a_{1},\dots,a_{n})\in R(\mathsf{L})\}$; 2. and if $\mathrm{sort}_{\mathtt{S}}(F)=(s_{1},\dots,s_{n},s)$ then for all $(a_{1},\dots,a_{n})\in s_{1}(\mathsf{L})\times\dots\times s_{n}(\mathsf{L})$ we have $\mathsf{h}_{s}(F(\mathsf{L})(a_{1},\dots,a_{n}))=F(\mathsf{M})(\mathsf{h}_{s_{% 1}}(a_{1}),\dots,\mathsf{h}_{s_{n}}(a_{n}))$.
Definition 2.1. [2, Definition 34] For a non-empty set $\mathtt{S}$ an $\mathtt{S}$-sorted predicate language $\mathfrak{L}$ is a tuple $\langle\mathrm{pred}_{\mathtt{S}},\,\mathrm{func}_{\mathtt{S}},\,\mathrm{ar}_{% \mathtt{S}},\,\mathrm{sort}_{\mathtt{S}}\rangle$ where: 1. each $s\in\mathtt{S}$ is called a sort; 2. the symbol $\mathrm{pred}_{\mathtt{S}}$ denotes a non-empty set of sorted predicate symbols; 3. the symbol $\mathrm{func}_{\mathtt{S}}$ denotes a set of sorted function symbols which is disjoint with $\mathrm{pred}_{\mathtt{S}}$; 4. the symbol $\mathrm{ar}_{\mathtt{S}}$ denotes an arity function $\mathrm{pred}_{\mathtt{S}}\sqcup\mathrm{func}_{\mathtt{S}}\to\mathbb{N}$; and 5. the symbol $\mathrm{sort}_{\mathtt{S}}$ denotes a sort function, taking any $n$-ary $R\in\mathrm{pred}_{\mathtt{S}}$ (respectively $F\in\mathrm{func}_{\mathtt{S}}$) to a sequence in $\mathtt{S}$ of length $n$ (respectively $n+1$). When $n>0$ in condition (v) we often write $\mathrm{sort}_{\mathtt{S}}(R)=(s_{1},\dots,s_{n})$ (respectively $\mathrm{sort}_{\mathtt{S}}(F)=(s_{1},\dots,s_{n},s)$). Note that functions $F$ with $\mathrm{ar}_{\mathtt{S}}(F)=0$ have a sort. For each sort $s$ we introduce a countable set $\mathcal{V}_{s}$ of variables of sort $s$. The terms of $\mathfrak{L}$ each have their own sort, and are defined inductively by stipulating: any variable $x$ of sort $s$ will be considered a term of sort $s$; and for any $F\in\mathrm{func}_{\mathtt{S}}$ with $\mathrm{sort}_{\mathtt{S}}(F)=(s_{1},\dots,s_{n},s)$ and for any terms $t_{1},\dots,t_{n}$ of sort $s_{1},\dots,s_{n}$ respectively, $F(t_{1},\dots,t_{n})$ is considered a term of sort $s$. Note that constant symbols, given by functions $F$ with $\mathrm{ar}_{\mathtt{S}}(F)=0$, are also terms. The atomic formulas with which $\mathfrak{L}$ is equipped are built from the equality $t=_{s}t^{\prime}$ between terms $t,t^{\prime}$ of common sort $s$, together with the formulas $R(t_{1},\dots,t_{n})$ where $R\in\mathrm{pred}_{\mathtt{S}}$, $\mathrm{sort}_{\mathtt{S}}(R)=(s_{1},\dots,s_{n})$ and where each $t_{i}$ is a term of sort $s_{i}$. First-order formulas $\varphi$ in $\mathfrak{L}$ are built from: the variables of each sort; the atomic formulas; binary connectives $\wedge$, $\vee$, and $\implies$; negation $\neg$; and the quantifiers $\forall$ and $\exists$. A positive-primitive or pp formula $\varphi(x_{1},\dots,x_{n})$ with free variables $x_{i}$ has the form $\begin{array}[]{c}\exists w_{n+1},\dots,w_{m}:\bigwedge_{j=1}^{k}\psi_{j}(x_{1% },\dots,x_{n},w_{n+1},\dots,w_{m})\end{array}$ where each $\psi_{j}$ is an atomic formula (see, for example, [7, p.50]).
Definition 5.7. [6, §1] Let $\mathcal{A}$ be a Grothendieck category with a set of finitely generated generators. Fix an object $\mathscr{M}$ of $\mathcal{A}$. We say that $\mathscr{M}$ is $\Sigma$-injective if, for any set $I$, the coproduct $\mathscr{M}^{(I)}=\bigoplus_{i\in I}\mathscr{M}$ is injective. We say that $\mathscr{M}$ is fp-injective if, whenever $0\to\mathscr{P}\to\mathscr{R}\to\mathscr{Q}\to 0$ is an exact sequence in $\mathcal{A}$ where $\mathscr{Q}$ is finitely presented, any morphism $\mathscr{P}\to\mathscr{M}$ extends to a morphism $\mathscr{R}\to\mathscr{M}$; see for example [4, §1].
Definition 2.6. [2, Definition 36] Fix a set $\mathtt{S}\neq\emptyset$ and an $\mathtt{S}$-sorted predicate language $\mathfrak{L}$. By an $\mathfrak{L}$-embedding we mean an $\mathfrak{L}$-homomorphism $\mathsf{h}:\mathsf{L}\to\mathsf{M}$ such that: 1. if $\varphi(x_{1},\dots,x_{n})$ is an atomic formula with $\mathrm{sort}_{\mathtt{S}}(x_{i})=s_{i}$, then for all $(a_{1},\dots,a_{n})\in s_{1}(\mathsf{L})\times\dots\times s_{n}(\mathsf{L})$, $\mathsf{L}\models\varphi(a_{1},\dots,a_{n})$ if and only if $\mathsf{M}\models\varphi(\mathsf{h}_{s_{1}}(a_{1}),\dots,\mathsf{h}_{s_{n}}(a_% {n}))$. By an $\mathfrak{L}$-pure embedding we mean an $\mathfrak{L}$-homomorphism $\mathsf{h}:\mathsf{L}\to\mathsf{M}$ such that: 2. if $\varphi(x_{1},\dots,x_{n})$ is a pp formula with $\mathrm{sort}_{\mathtt{S}}(x_{i})=s_{i}$, then for all $(a_{1},\dots,a_{n})\in s_{1}(\mathsf{L})\times\dots\times s_{n}(\mathsf{L})$, if $\mathsf{M}\models\varphi(\mathsf{h}_{s_{1}}(a_{1}),\dots,\mathsf{h}_{s_{n}}(a_% {n}))$ then $\mathsf{L}\models\varphi(a_{1},\dots,a_{n})$.
Definition 3.6. [13, Definition 1.1] A morphism $h:L\to M$ in $\mathcal{T}$ is called a pure monomorphism if $\mathbf{Y}(h)_{X}:\mathcal{T}(X,L)\to\mathcal{T}(X,M)$ is injective for each object $X$ of $\mathcal{T}^{c}$.
Definition 3.1. [14, Definition 1.1] Let $\mathcal{T}$ be a triangulated category with suspension functor $\Sigma$, and assume all small coproducts exist in $\mathcal{T}$. An object $X$ of $\mathcal{T}$ is said to be compact if, for any set $I$ and collection $\mathrm{M}=\{M_{i}\mid i\in I\}$ of objects in $\mathcal{T}$, the morphism $\gamma_{X,\mathrm{M}}$ is an isomorphism. Let $\mathcal{T}^{c}$ be the full triangulated subcategory of $\mathcal{T}$ consisting of compact objects. Given a set $\mathcal{G}$ of compact objects in $\mathcal{T}$, we say that $\mathcal{T}$ is compactly generated by $\mathcal{G}$ if there are no non-zero objects $M$ in $\mathcal{T}$ satisfying $\mathcal{T}(X,M)=0$ for all $X\in\mathcal{G}$ (or, said another way, any non-zero object $M$ gives rise to a non-zero morphism $X\to M$ for some $X\in\mathcal{G}$). If $\mathcal{T}$ is compactly generated by $\mathcal{G}$ we call $\mathcal{G}$ a generating set provided $\Sigma X\in\mathcal{G}$ for all $X\in\mathcal{G}$.
Definition 5.2. [6, §1] Let $\mathcal{A}$ be a Grothendieck category with a set $\{\mathscr{G}_{\alpha}\mid\alpha\in\Omega\}$ of finitely generated generators. Let $\mathscr{Q}$ and $\mathscr{R}$ be objects in $\mathcal{A}$. A subobject $\mathscr{P}$ of $\mathscr{Q}$ is said to be an $\mathscr{R}$-annihilator subobject of $\mathscr{Q}$ provided $\mathscr{P}=\bigcap\mathrm{ker}(\theta)$ where the intersection runs over all $\theta$ from some subset $\mathtt{K}$ of $\mathcal{A}(\mathscr{Q},\mathscr{R})$.
Definition 6.4. [12, Definition 1.1] An object $M$ of $\mathcal{T}$ is called pure-injective if each pure monomorphism $M\to N$ is a section, and $M$ is called $\Sigma$-pure-injective if, for any set $I$, the coproduct $\bigoplus_{i\in I}M=M^{(I)}$ is pure-injective.
Definición 5 Dada una relación $X\overset{\tau}{\longrightarrow}Y$ en $\text{{Rel}}(D^{\#})$ y $A\subseteq X$, se define la imagen de $A$ bajo $\tau$ como $Im_{\tau}(A)=\left\{b\in Y\,:\,\exists a\in A,\,a\tau b\right\}.$ Si $\mathcal{P}(X)$ denota el conjunto potencia de $X$ y dado $A\in\mathcal{P}(X)$ , se define la función asociada a $\tau$ como, $\displaystyle f_{\tau}:\mathcal{P}(X)$ $\displaystyle\longrightarrow$ $\displaystyle\mathcal{P}(Y)$ $\displaystyle A$ $\displaystyle\longmapsto$ $\displaystyle Im_{\tau}(A).$ Se puede observar que $f_{\tau}$ está bien definida puesto que si $X\overset{\tau}{\longrightarrow}Y$ es una relación en $\text{{Rel}}(D^{\#})$, $A,B\in\mathcal{P}(X)$ son tales que $A=B$ entonces $Im_{\tau}(A)=Im_{\tau}(B)$. La siguiente proposición relaciona estos nuevos conceptos con los anteriores.
